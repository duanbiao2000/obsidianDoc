**持续部署（Continuous Deployment, CD）** 是软件工程中 DevOps 流水线的关键阶段，指将通过所有测试的代码**自动部署到生产环境**，不需要人工干预。

---

## 🚀 持续部署 vs 持续交付 vs 持续集成

|名称|目标|是否自动上线|触发方式|
|---|---|---|---|
|**CI（持续集成）**|自动构建+测试|否|push 或 PR|
|**CD（持续交付）**|可随时发布|否|人工发布|
|**CD（持续部署）**|自动上线|✅|push/merge 自动上线|

---

## 🧱 核心流程

持续部署通常包含以下阶段：

1. **代码提交（Git）**
    
    - 开发人员提交代码或合并 PR；
        
2. **持续集成（CI）**
    
    - 触发流水线：单元测试、构建（`mvn package`）、静态扫描；
        
3. **制品上传（如 JAR、Docker 镜像）**
    
    - 上传至制品库（如 Nexus、Harbor）；
        
4. **部署到生产**
    
    - 使用 CD 工具自动部署（如 ArgoCD / Jenkins / GitHub Actions）；
        
5. **服务发现与流量切换**
    
    - 配合 Kubernetes + Istio 进行 Canary / Blue-Green 发布；
        
6. **监控与告警**
    
    - 使用 Prometheus + Grafana + Alertmanager 实时监控；
        
7. **自动回滚（可选）**
    
    - 部署失败或指标异常时自动回滚上一版本。
        

---

## 🔧 技术选型（现代微服务栈）

| 阶段      | 工具                                   | 说明        |
| ------- | ------------------------------------ | --------- |
| CI      | GitHub Actions / GitLab CI / Jenkins | 自动测试 & 构建 |
| 构建 & 制品 | Maven / Gradle + Docker              | 构建产物      |
| 镜像仓库    | Harbor / Docker Hub                  | 存放镜像      |
| CD      | ArgoCD / FluxCD / Jenkins            | 自动部署      |
| 环境      | Kubernetes（K8s）                      | 运行容器      |
| 流量控制    | Istio / NGINX Ingress                | 灰度发布      |
| 配置中心    | Nacos / Consul / Spring Cloud Config | 动态配置      |
| 监控      | Prometheus + Grafana                 | 可观测性      |
| 日志      | EFK / Loki                           | 日志分析      |

---

## 🎯 持续部署优势

- ✅ 快速上线
    
- ✅ 无人工干预
    
- ✅ 自动化回滚
    
- ✅ 频繁迭代
    
- ✅ 提升稳定性
    

---

## 🧠 示例：Spring Boot + Docker + K8s + ArgoCD

1. 代码推送 → GitHub Actions 构建 → 打包为 Docker 镜像；
    
2. 推送镜像到 Harbor；
    
3. 更新 `Deployment.yaml` 镜像 tag；
    
4. ArgoCD 检测到 Git 变更 → 自动同步部署；
    
5. Istio 实现 Canary 发布（10% → 50% → 100%）；
    
6. Prometheus 检测异常指标自动回滚。
    

---

需要我为你生成一个 Spring Boot 项目 + GitHub Actions + ArgoCD 的完整 CD 示例吗？可以一键部署上 K8s 的那种。