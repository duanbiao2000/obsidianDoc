
## 软件系统设计文档的定位

软件系统设计文档（System Design Document / Technical Design Document）是介于 PRD 和最终代码实现之间的**技术架构蓝图**，主要解决"系统如何设计"的问题 。[1][2]

***

## 三者在开发流程中的递进关系

**完整的产品开发链条：**

```
业务需求 → PRD → 系统设计文档 → Spec → 开发实现 → 测试 → 上线
         (做什么)   (怎么架构)    (怎么实现)
```

### 各阶段核心职责对比

| 文档类型 | 核心问题 | 关注层次 | 主要产出者 | 典型内容 |
|---------|---------|---------|-----------|---------|
| **PRD** | 做什么？为什么做？ | 产品/业务层 | 产品经理 | 用户场景、功能列表、成功指标 |
| **系统设计文档** | 用什么架构实现？ | 系统架构层 | 技术负责人/架构师 | 技术选型、模块划分、数据流 [1] |
| **Spec** | 具体怎么编码？ | 实现细节层 | 开发工程师 | 接口定义、数据表结构、业务逻辑 |

***

## 系统设计文档的典型内容

根据业界实践，系统设计文档通常包含以下章节 ：[3][2][1]

**架构设计**
- 系统整体架构图（C/S、微服务、分层架构等）
- 技术栈选型（前端框架、后端语言、数据库类型）
- 部署方案（单机/集群、容器化等）

**模块划分**
- 功能模块的边界定义
- 模块间的依赖关系
- 核心模块的职责说明

**关键设计决策**
- 数据存储方案（SQL vs NoSQL）
- 缓存策略（Redis 使用场景）
- 消息队列选型（Kafka/RabbitMQ）

**非功能性需求**
- 性能指标（并发量、响应时间）
- 安全方案（认证鉴权、数据加密）
- 可扩展性设计

**接口规范**
- API 设计原则（RESTful/GraphQL）
- 数据格式约定（JSON Schema）

***

## 实际案例：优惠券系统的三层文档

### PRD 层（产品经理输出）
```
目标：提升优惠券使用率至 40%
核心功能：领取、查看、使用优惠券
成功指标：订单转化率提升 8%
```

### 系统设计文档层（技术负责人输出）
```
架构方案：
- 前端：React + Redux
- 后端：Node.js + Express
- 数据库：MySQL（存储优惠券）+ Redis（缓存库存）

模块划分：
1. 用户中心模块（管理用户券包）
2. 优惠券服务模块（领取、核销逻辑）
3. 订单结算模块（自动抵扣计算）

关键设计：
- 使用分布式锁解决超发问题
- 优惠券库存采用 Redis 预扣减 + 异步补偿机制
- 支持 QPS 1000，P99 延迟 < 300ms
```

### Spec 层（开发工程师输出）
```
接口详细定义：
POST /api/v1/coupons/claim
参数：coupon_id, user_id
返回：coupon_code, expire_at
错误码：4001（已抢光）、4002（已领取）

数据表设计：
user_coupons 表字段：
- id (bigint)
- user_id (bigint, 索引)
- status (tinyint: 0=未使用 1=已使用 2=已过期)

Redis 键设计：
coupon:stock:{coupon_id} → 剩余库存数
```

***

## 为什么需要三层文档？

**分层的核心价值：**

1. **职责分离**[4][5]
   - PRD 让业务方理解产品价值
   - 系统设计让架构师把控技术方向
   - Spec 让开发工程师聚焦实现细节

2. **降低沟通成本**  
   产品经理不需要理解 Redis 锁机制，开发工程师也不需要参与商业策略讨论

3. **支持并行工作**[6]
   架构师设计系统时，产品经理可以同步准备下个版本 PRD；前后端可以基于 API Spec 并行开发

4. **风险控制**[7]
   系统设计阶段及早发现技术瓶颈（如单库无法支撑高并发），避免返工

***

## 敏捷团队的简化实践

在快速迭代的初创团队中，可能采用**两层文档模式** ：[8][4]

- **轻量 PRD** = 用户故事 + 原型图（Figma）
- **代码即文档** = 直接在 Swagger 定义 API + 设计稿中标注交互逻辑

但对于**复杂系统**（如金融支付、实时通信），仍需独立的系统设计文档来确保架构稳定性 。[2][1]

***

**核心总结**：PRD 定义产品价值，系统设计文档确定技术架构，Spec 落实实现细节。三者协同确保从业务目标到代码交付的顺畅衔接 。[9][10]
