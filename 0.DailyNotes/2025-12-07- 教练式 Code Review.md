以下是几个典型的 **教练式 Code Review（代码评审）实例**，展示了如何以**引导、启发、尊重和成长为导向**的方式进行反馈，而非简单指出错误或命令式修改。这类 CR 特别适合用于培养新人、提升团队协作氛围或推动工程文化。

---

### 🌟 实例 1：函数职责过重（引导拆分）

#### 被评审代码（简化）：

```python
def process_user_data(user_id):
    user = fetch_user(user_id)
    if not user:
        log_error("User not found")
        return None
    validate_email(user.email)
    send_welcome_email(user)
    update_last_login(user)
    record_analytics(user)
    return user
```

#### ❌ 普通 CR：

> 这个函数太长了，职责太多，拆成几个小函数。

#### ✅ 教练式 CR：

> 这个函数目前处理了数据获取、校验、通知、状态更新和埋点等多个任务。我在读的时候稍微花了点时间理清逻辑 😅  
> 你有没有考虑过按“单一职责原则”把它拆分成几个更专注的小函数？比如 `validate_and_notify()` 或 `update_user_activity()`？  
> 这样可能更容易测试，也方便未来单独修改某一部分逻辑。你觉得呢？

> 💡 **教练要点**：
> 
> - 先肯定（隐含：代码能跑通、逻辑完整）
> - 表达自己的阅读体验（非指责）
> - 提出原则（单一职责）+ 建议方向
> - 用提问结尾，邀请对方思考

---

### 🌟 实例 2：边界条件未处理（启发思考）

#### 被评审代码：

```javascript
function calculateDiscount(price, rate) {
  return price * (1 - rate);
}
```

#### ❌ 普通 CR：

> 没有校验输入，rate 可能是负数或大于 1，会出错。

#### ✅ 教练式 CR：

> 这个折扣计算逻辑很清晰！👍  
> 我在想，如果调用方不小心传入 `rate = 1.5` 或 `rate = -0.2`，结果可能会让用户看到负价格或者价格暴涨 😬  
> 你是否考虑过对 `rate` 做一个范围校验（比如 0 ≤ rate ≤ 1）？或者在文档里明确说明预期输入？  
> 这样可以避免意外情况，也能让接口更健壮。

> 💡 **教练要点**：
> 
> - 先表扬简洁性
> - 用“我在想…”表达担忧，而非断言错误
> - 给出具体场景（负价格）增强感知
> - 提供多个选项（校验 or 文档）

---

### 🌟 实例 3：可测试性问题（引导设计改进）

#### 被评审代码：

```go
func SendEmail(to string, subject string) error {
    client := smtp.NewClient(...) // 硬编码创建客户端
    return client.Send(to, subject)
}
```

#### ❌ 普通 CR：

> 不能单元测试，依赖写死了，要注入。

#### ✅ 教练式 CR：

> 这个邮件发送功能实现得很直接！  
> 我注意到 `smtp.NewClient` 是在函数内部直接调用的，这可能会让单元测试变得困难（因为我们无法 mock 客户端）。  
> 如果未来我们要验证“当 SMTP 服务不可用时是否重试”，该怎么测呢？  
> 也许可以把客户端作为参数传入，或者通过接口注入？这样既能保持逻辑清晰，又能提升可测试性。你对这种解耦方式怎么看？

> 💡 **教练要点**：
> 
> - 聚焦“未来需求”（如重试逻辑）引发思考
> - 用反问引导对方意识到测试痛点
> - 提出通用解法（注入/接口），但不强制

---

### 🌟 实例 4：命名不够清晰（温和建议）

#### 被评审代码：

```java
public void handle(int x) { ... }
```

#### ❌ 普通 CR：

> 变量名 x 太模糊，改掉。

#### ✅ 教练式 CR：

> 这个 `handle` 方法看起来是在处理某种业务逻辑 👀  
> 不过光看 `x` 这个参数名，我一时没猜出它代表什么（用户 ID？订单状态码？）。  
> 如果改成像 `userId` 或 `orderStatus` 这样的名字，是不是能让调用者和未来的维护者更快理解意图？  
> 当然，如果你觉得上下文已经足够清晰，也可以忽略这个建议 😊

> 💡 **教练要点**：
> 
> - 承认自己“没看懂”（降低攻击性）
> - 强调受益者（调用者、维护者）
> - 给出具体命名示例
> - 允许对方保留判断（“可以忽略”）

---

### ✅ 教练式 CR 的核心原则总结：

|原则|说明|
|---|---|
|**先肯定，再建议**|找到代码中的亮点（哪怕很小）|
|**用“我”代替“你”**|“我有点困惑” vs “你写得不清楚”|
|**提问 > 命令**|“是否考虑过…？” vs “你必须改”|
|**解释“为什么”**|说明改进带来的价值（可维护性、安全性等）|
|**提供选择，而非唯一答案**|给出 1~2 种方案，让作者决策|
|**保持心理安全**|避免羞辱、讽刺、过度批评|

---

### 📚 延伸建议

- 团队可建立 **“教练式 CR 指南”**，收录正反例。
- 在 PR 模板中加入提示：“请使用建设性、引导式语言进行评审”。
- 对新人 PR，可指定一位“教练型 reviewer”重点培养。

---

如果你需要针对特定语言（如 Python/Go/Java）或场景（性能、安全、并发）的教练式 CR 示例，也可以告诉我，我可以继续补充！

[[教练式CodeReview特征指南]]