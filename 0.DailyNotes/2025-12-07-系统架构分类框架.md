---
view-count: 6
---

## 核心公式
**架构 = 权衡 (Trade-off)**
**复杂度 $\propto$ 状态同步成本**
**陷阱 = 忽视非线性边界**

---

## 1. 核心系统冲突与破局

| 系统分类 | 核心冲突 | 破局关键 |
|:--- |:--- |:--- |
| **网络系统** | 延迟 vs 带宽 | 连接复用 (H2/QUIC) + 协议压缩 |
| **数据库** | 一致性 vs 可用性 | 权衡一致性模型；Saga/补偿事务 |
| **消息队列** | 顺序性 vs 吞吐量 | 幂等设计 + 动态流控 + 多分区并行 |
| **流处理** | 实时性 vs 准确性 | Watermark 策略 + 精准一次 (Exactly-Once) |
| **日志/仓储** | 检索速度 vs 成本 | 热冷分离 + 索引降噪 + 数据倾斜优化 |
| **库存/支付** | 高并发 vs 准确性 | 预留+确认机制；强幂等控制；实时对账 |
| **身份/权限** | 安全 vs 性能 | Token 生命周期权衡；细粒度缓存策略 |
| **AI 训练** | GPU 利用率 vs 通信开销 | 数据/模型并行策略；异步 Checkpoint |
| **云原生** | 可靠性 vs 复杂度 | 熔断重试机制；故障域隔离；连接池优化 |

---

## 2. 架构避坑雷达 (常见陷阱)

- **过度设计 |** 业务可容忍最终一致，却强推强一致导致性能崩溃。
- **环境偏差 |** 将局域网优化策略直接搬到公网，忽视高延迟/丢包。
- **资源浪费 |** 对 TB 级日志全字段建立全文索引，导致存储成本失控。
- **状态爆炸 |** 无状态流处理外推至有状态计算，未考虑状态集合的无界增长。
- **级联故障 |** 缺少降级/超时处理，单个下游服务故障拖垮全局。

---

## 3. 架构师诊断三步法

1. **定位层级 |** 基础设施、数据处理、业务逻辑、还是安全合规？
2. **提取矛盾 |** 该场景下最不可调和的两个变量是什么？
3. **边界模拟 |** 流量/数据量增加 10 倍，哪个节点最先发生“非线性崩溃”？

---

## 4. 实践自检

- [ ] 是否明确定义了业务可容忍的“底线” (如延迟、一致性窗口)？
- [ ] 方案是否具备“故障恢复点” (Checkpoint/Recovery Plan)？
- [ ] 核心流程是否实现了“全链路幂等”？
- [ ] 针对热点数据/查询是否有“本地化”或“隔离”策略？

---

## 黄金法则
**没有完美方案，只有在特定约束下成本最优的权衡。**

---
**关联笔记：** [[2025-12-10-高质量开源项目的特征]] | [[Roadmap]]