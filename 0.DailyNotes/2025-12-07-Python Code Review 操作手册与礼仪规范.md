# Python Code Review æ“ä½œæ‰‹å†Œä¸ç¤¼ä»ªè§„èŒƒ

## ğŸ“Œ æ ¸å¿ƒå“²å­¦

ä½œä¸ºèµ„æ·±å·¥ç¨‹å¸ˆçš„ä½ ï¼ŒCode Review ä¸æ˜¯**å±•ç¤ºæƒå¨çš„èˆå°**ï¼Œè€Œæ˜¯**å›¢é˜Ÿå­¦ä¹ ä¸ä»£ç è´¨é‡å…±è¿›çš„è¿‡ç¨‹**ã€‚æ¯æ¡è¯„è®ºéƒ½åº”è¯¥ï¼š

- âœ… å¸®åŠ© PR ä½œè€…æˆé•¿
- âœ… æé«˜ä»£ç å¯ç»´æŠ¤æ€§
- âœ… å»ºç«‹å¿ƒç†å®‰å…¨çš„è¯„å®¡æ–‡åŒ–
- âŒ ä¸ä¸ºäº†è¯æ˜è‡ªå·±æ¯”åˆ«äººæ‡‚å¾—å¤š

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šæ²Ÿé€šç¤¼ä»ªè§„èŒƒ

### 1. å‰ç½®åŸåˆ™ï¼šè¯„å®¡å‰çš„å¿ƒæ€

#### ğŸ“– åŸåˆ™ 1.1ï¼šå‡è®¾å¥½æ„

- **ä¸è¦æƒ³**ï¼š"è¿™å“¥ä»¬ä»£ç æ€ä¹ˆå†™çš„è¿™ä¹ˆçƒ‚ï¼Ÿ"
- **è¦æƒ³**ï¼š"è¿™ä¸ªäººå¯èƒ½åœ¨æŸä¸ªç¯èŠ‚ä¸­åšäº†æƒè¡¡ï¼Œæˆ‘æ¥ç†è§£ä¸€ä¸‹ã€‚"
- **å®è·µ**ï¼šè¯„è®ºå‰ï¼Œå…ˆè¯»ä¸€é PR æè¿°å’Œä¸Šä¸‹æ–‡ï¼Œç†è§£ä½œè€…çš„æ„å›¾ã€‚

#### ğŸ“– åŸåˆ™ 1.2ï¼šåŒºåˆ†"é—®é¢˜"ä¸"åå¥½"

- **é—®é¢˜**ï¼šå®‰å…¨æ¼æ´ã€æ€§èƒ½ç“¶é¢ˆã€æ•°æ®ç«æ€ã€æœªå¤„ç†çš„å¼‚å¸¸
- **åå¥½**ï¼šå‘½åé£æ ¼ã€ä»£ç ç»„ç»‡æ–¹å¼ã€æŸä¸ªåº“çš„é€‰æ‹©

**å¯¹å¾…æ–¹å¼å·®å¼‚ï¼š**

```
é—®é¢˜ âŒ "è¿™é‡Œæœ‰ SQL æ³¨å…¥é£é™©ï¼Œå¿…é¡»ç”¨å‚æ•°åŒ–æŸ¥è¯¢ã€‚"
åå¥½ âœ… "æˆ‘æ³¨æ„åˆ°è¿™é‡Œç›´æ¥å­—ç¬¦ä¸²æ‹¼æ¥ SQLï¼Œç”¨å‚æ•°åŒ–ä¼šä¸ä¼šæ›´å®‰å…¨ï¼Ÿ"

é—®é¢˜ âŒ "ä½ è¿™ä¸ªå‡½æ•°å¤æ‚åº¦å¤ªé«˜ï¼Œæˆ‘çœ‹ä¸æ‡‚ã€‚"
åå¥½ âœ… "è¿™ä¸ªå‡½æ•°é€»è¾‘å¾ˆå¯†é›†ï¼Œæˆ‘ä»¬å¯ä»¥æ‹†æˆå‡ ä¸ªå°å‡½æ•°å—ï¼Ÿè¿™æ ·ä¼šæ›´å®¹æ˜“æµ‹è¯•ã€‚"
```

#### ğŸ“– åŸåˆ™ 1.3ï¼šå°Šé‡ä¸Šä¸‹æ–‡

- ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿå…ˆé—®ï¼Œåˆ«æ€¥ç€æ‰¹è¯„ã€‚
- **åä¾‹**ï¼š"ä¸ºä»€ä¹ˆä¸ç”¨ async/awaitï¼Ÿ"ï¼ˆå¯èƒ½æœ‰é—ç•™å…¼å®¹æ€§åŸå› ï¼‰
- **å¥½ä¾‹**ï¼š"æˆ‘çœ‹è¿™é‡Œç”¨äº†åŒæ­¥ I/Oï¼Œæœ‰è€ƒè™‘è¿‡æ”¹æˆ async å—ï¼Ÿæœ‰ä»€ä¹ˆçº¦æŸå—ï¼Ÿ"

---

### 2. è¯„è®ºçš„å…·ä½“å†™æ³•

#### ğŸ¯ è§„èŒƒ 2.1ï¼šç”¨"æˆ‘"å¼€å¤´ï¼Œè€Œé"ä½ "

|âŒ é¿å…|âœ… æ”¹è¿›|
|---|---|
|"ä½ è¿™é‡Œçš„å˜é‡åå¤ªé•¿äº†ã€‚"|"æˆ‘å‘ç°è¿™ä¸ªå˜é‡åå¯¹æˆ‘æ¥è¯´å¾ˆéš¾ä¸€çœ¼æ‰«è¿‡ï¼Œå¯ä»¥ç®€åŒ–å—ï¼Ÿ"|
|"è¿™ä¸ª API è®¾è®¡é”™äº†ã€‚"|"æˆ‘æƒ³äº†æƒ³è¿™ä¸ª APIï¼Œå¦‚æœæ”¹æˆâ€¦â€¦ä¼šä¸ä¼šæ›´ç¬¦åˆç°æœ‰çš„çº¦å®šï¼Ÿ"|
|"ä½ æ²¡æœ‰å¤„ç†è¾¹ç•Œæƒ…å†µã€‚"|"æˆ‘æ³¨æ„åˆ°è¿™é‡Œæ²¡æœ‰å¤„ç† None çš„æƒ…å†µï¼Œéœ€è¦åŠ ä¸ªæ£€æŸ¥å—ï¼Ÿ"|

**åŸç†**ï¼šä¸»è¯­ä»"ä½ "æ”¹æˆ"æˆ‘"ï¼Œç«‹åˆ»ä»æŒ‡è´£å˜æˆå¯¹è¯ã€‚

---

#### ğŸ¯ è§„èŒƒ 2.2ï¼šæé—®ä¼˜äºæŒ‡ä»¤

|âŒ æŒ‡ä»¤å¼|âœ… æé—®å¼|
|---|---|
|"æŠŠè¿™ä¸ªæ”¹æˆ list comprehensionã€‚"|"è¿™é‡Œèƒ½æ”¹æˆ list comprehension å—ï¼Ÿä¼šæ›´ç®€æ´ã€‚"|
|"åŠ ä¸Šç±»å‹æ³¨è§£ã€‚"|"è¿™ä¸ªå‡½æ•°åŠ ä¸Šç±»å‹æ³¨è§£ä¼šä¸ä¼šæé«˜å¯è¯»æ€§ï¼Ÿç‰¹åˆ«æ˜¯å¯¹äºæ–°æ‰‹ã€‚"|
|"ç”¨ logging æ›¿ä»£ printã€‚"|"è¿™é‡Œç”¨ print æ˜¯ä¸ºäº†è°ƒè¯•å—ï¼Ÿå¦‚æœç”¨ logging ä¼šä¸ä¼šä¾¿äºç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Ÿ"|

**æ•ˆæœ**ï¼šæé—®ç»™å¯¹æ–¹æ€è€ƒå’Œè§£é‡Šçš„æœºä¼šï¼Œè€Œéå•å‘å‘½ä»¤ã€‚

---

#### ğŸ¯ è§„èŒƒ 2.3ï¼šè§£é‡Š"ä¸ºä»€ä¹ˆ"ï¼Œè€Œéåªè¯´"æ˜¯ä»€ä¹ˆ"

|âŒ ç¼ºä¹ä¸Šä¸‹æ–‡|âœ… æä¾›ç†ç”±|
|---|---|
|"è¿™é‡Œåº”è¯¥ç”¨ `defaultdict`ã€‚"|"è¿™é‡Œæ¯æ¬¡éƒ½è¦æ£€æŸ¥ key æ˜¯å¦å­˜åœ¨ï¼Œç”¨ `defaultdict` æˆ– `setdefault` ä¼šç®€åŒ–é€»è¾‘ã€‚"|
|"åŠ å•å…ƒæµ‹è¯•ã€‚"|"è¿™ä¸ªæ•°æ®è½¬æ¢é€»è¾‘æœ‰å‡ ä¸ªè¾¹ç•Œæƒ…å†µï¼ˆè´Ÿæ•°ã€ç©ºåˆ—è¡¨ã€è¶…å¤§å€¼ï¼‰ï¼Œå•å…ƒæµ‹è¯•èƒ½é˜²æ­¢æœªæ¥çš„å›å½’ã€‚"|
|"è¿™ä¸ªæŸ¥è¯¢ä¼šå¾ˆæ…¢ã€‚"|"è¿™ä¸ªæŸ¥è¯¢æ²¡æœ‰ç´¢å¼•ï¼Œæ•°æ®é‡å¤§äº†ä¹‹å O(n) æ‰«è¡¨ä¼šæˆä¸ºç“¶é¢ˆã€‚æˆ‘ä»¬èƒ½åŠ ä¸ªç´¢å¼•å—ï¼Ÿ"|

**æ”¶ç›Š**ï¼šè®©å¯¹æ–¹ç†è§£èƒŒåçš„å·¥ç¨‹è€ƒè™‘ï¼Œè€Œä¸ä»…æ˜¯"è€å¤§è¯´äº†ç®—"ã€‚

---

#### ğŸ¯ è§„èŒƒ 2.4ï¼šåœ¨èµåŒå’Œæ”¹è¿›ä¹‹é—´å¹³è¡¡

|âŒ åªæŒ‘å‰”|âœ… å¹³è¡¡åé¦ˆ|
|---|---|
|"è¿™ä¸ªå¼‚å¸¸å¤„ç†æœ‰é—®é¢˜ã€‚"|"æˆ‘å–œæ¬¢ä½ å¯¹å¼‚å¸¸çš„åˆ†ç±»å¤„ç†ï¼Œä¸è¿‡è¿™é‡Œæ˜¯ä¸æ˜¯æ¼äº† `KeyError` çš„æƒ…å†µï¼Ÿ"|
|"æ€§èƒ½ä¼˜åŒ–å¾—ä¸å¤Ÿã€‚"|"æŸ¥è¯¢ä¼˜åŒ–å¾—å¾ˆå¥½ï¼Œä¸è¿‡ç¼“å­˜è¿™é‡Œå¥½åƒè¿˜æ˜¯æ²¡æœ‰ TTLï¼Œæ‹…å¿ƒæ•°æ®ä¸ä¸€è‡´ï¼Ÿ"|
|"ä»£ç é‡å¤å¤ªå¤šã€‚"|"æ•´ä½“é€»è¾‘æ¸…æ™°ï¼Œä¸‰ä¸ªå‡½æ•°æœ‰ç›¸ä¼¼çš„æ ¡éªŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬èƒ½æå–æˆä¸€ä¸ª helper å—ï¼Ÿ"|

**å¿ƒç†å­¦åŸºç¡€**ï¼šäººæ›´å®¹æ˜“æ¥å—"è‚¯å®š + å»ºè®®"ï¼Œè€Œé"å¦å®š + æŒ‡è´£"ã€‚

---

#### ğŸ¯ è§„èŒƒ 2.5ï¼šæä¾›å…·ä½“ç¤ºä¾‹æˆ–å‚è€ƒ

|âŒ ç¬¼ç»Ÿ|âœ… å…·ä½“|
|---|---|
|"å‘½åä¸ç¬¦åˆè§„èŒƒã€‚"|"æŒ‰ PEP 8ï¼Œç§æœ‰æ–¹æ³•ç”¨ `_method_name()`ï¼Œè¿™é‡Œå¯ä»¥æ”¹æˆ `_validate_user()` å—ï¼Ÿ"|
|"è¿™ä¸ªå‡½æ•°å¤ªå¤æ‚ã€‚"|"è¿™ä¸ªå‡½æ•°æœ‰ä¸‰å±‚ if åµŒå¥—ï¼Œå¯ä»¥è¯•è¯•ç”¨å«è¯­å¥ï¼ˆguard clauseï¼‰æ¥æ‰å¹³åŒ–ï¼Ÿåƒè¿™æ ·â€¦â€¦"|
|"éœ€è¦ä¼˜åŒ–ã€‚"|"è¿™é‡Œå¯¹åˆ—è¡¨åšäº†ä¸‰æ¬¡éå†ï¼Œèƒ½åˆå¹¶æˆä¸€æ¬¡å—ï¼Ÿ[é™„ä¸Šç¤ºä¾‹ä»£ç ]"|

**é™„åŠ ä»·å€¼**ï¼šå…·ä½“ä¾‹å­é™ä½ç†è§£æˆæœ¬ï¼Œå¯¹æ–¹æ›´å®¹æ˜“é‡‡çº³ã€‚

---

#### ğŸ¯ è§„èŒƒ 2.6ï¼šåŒºåˆ†"é˜»æ–­"ä¸"å»ºè®®"

ä½¿ç”¨æ ‡è®°æ¥æ˜ç¡®è¯„è®ºçš„ä¸¥é‡æ€§ï¼š

```
ğŸ›‘ MUST FIX (éœ€è¦ä¿®æ”¹ï¼Œå¦åˆ™ä¸èƒ½åˆå¹¶)
- SQL æ³¨å…¥é£é™©
- æ•°æ®ç«æ€æ¡ä»¶
- æœªå¤„ç†çš„å¼‚å¸¸å¯¼è‡´ç¨‹åºå´©æºƒ
- è¿åå…³é”®ä¸šåŠ¡é€»è¾‘

ğŸ’¡ SUGGESTION (å»ºè®®æ”¹è¿›ï¼Œä¸å¼ºåˆ¶)
- æ€§èƒ½ä¼˜åŒ–ç©ºé—´
- ä»£ç é£æ ¼æˆ–ç»„ç»‡
- å¯è¯»æ€§æ”¹è¿›
- æµ‹è¯•è¦†ç›–ç‡æé«˜

â“ QUESTION (æˆ‘æƒ³äº†è§£)
- "è¿™é‡Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ªç®—æ³•ï¼Ÿ"
- "æœ‰è€ƒè™‘è¿‡â€¦â€¦å—ï¼Ÿ"
```

**å®è·µç¤ºä¾‹ï¼š**

```python
# ğŸ›‘ MUST FIX
# è¿™é‡Œç›´æ¥æ‰§è¡Œ SQLï¼Œæœ‰æ³¨å…¥é£é™©ã€‚åº”è¯¥ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼š
# cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))

# ğŸ’¡ SUGGESTION
# è¿™ä¸ªå¾ªç¯å¯ä»¥ç”¨ list comprehension æ›´ç®€æ´

# â“ QUESTION
# æˆ‘å¥½å¥‡ä¸ºä»€ä¹ˆè¿™é‡Œé€‰æ‹©äº† Redis è€Œä¸æ˜¯ Memcachedï¼Ÿæœ‰ä»€ä¹ˆè€ƒé‡å—ï¼Ÿ
```

---

### 3. è¯„å®¡æµç¨‹çš„èŠ‚å¥æ„Ÿ

#### â±ï¸ è§„èŒƒ 3.1ï¼šç¬¬ä¸€éå¿«é€Ÿé€šè¯»ï¼Œç¬¬äºŒéæ·±å…¥è¯„å®¡

- **ç¬¬ä¸€é**ï¼ˆ5 åˆ†é’Ÿï¼‰ï¼šç†è§£ PR çš„ç›®çš„ã€æ¶‰åŠçš„æ–‡ä»¶ã€æ•´ä½“è®¾è®¡
- **ç¬¬äºŒé**ï¼ˆ10-20 åˆ†é’Ÿï¼‰ï¼šé€è¡Œé˜…è¯»å…³é”®éƒ¨åˆ†ï¼Œå¯»æ‰¾é€»è¾‘æ¼æ´ã€è¾¹ç•Œæƒ…å†µã€æ€§èƒ½é—®é¢˜
- **ç¬¬ä¸‰é**ï¼ˆå¦‚éœ€è¦ï¼‰ï¼šéªŒè¯æµ‹è¯•è¦†ç›–ã€æ–‡æ¡£æ›´æ–°ã€é…ç½®å˜æ›´

#### â±ï¸ è§„èŒƒ 3.2ï¼šä¸€æ¬¡è¯„å®¡çš„è¯„è®ºæ•°é‡

- å¦‚æœä¸€æ¬¡æ€§æå‡º 8+ æ¡ç‹¬ç«‹è¯„è®ºï¼Œå¯¹æ–¹ä¼šæ„Ÿåˆ°æ·¹æ²¡ã€‚
- **å»ºè®®**ï¼šæŒ‰ä¼˜å…ˆçº§åˆ†ç»„
    - å¿…é¡»æ”¹ï¼šåˆ—åœ¨æœ€å‰é¢
    - å¼ºçƒˆå»ºè®®ï¼šå•ç‹¬æ®µè½
    - å¯é€‰ä¼˜åŒ–ï¼šæœ€åæåŠï¼Œæˆ–è€…ä¸‹æ¬¡è¿­ä»£

**ç¤ºä¾‹ï¼š**

```
## å¿…é¡»ä¿®æ”¹

1. L45ï¼šè¿™ä¸ª SQL éœ€è¦å‚æ•°åŒ–â€¦â€¦

## å¼ºçƒˆå»ºè®®

2. L78ï¼šè¿™ä¸ªå¼‚å¸¸å¤„ç†å¯ä»¥â€¦â€¦

## å¯é€‰ï¼ˆä¸‹æ¬¡è¿­ä»£å¯è€ƒè™‘ï¼‰

3. L120ï¼šå¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œå¯ä»¥â€¦â€¦
```

#### â±ï¸ è§„èŒƒ 3.3ï¼šå¦‚æœ PR ä½œè€…æœ‰å¤šä¸ªåç»­æäº¤ï¼Œé‡æ–°è¯„å®¡

- ä¸è¦åªçœ‹ diffï¼Œè¦ä»æ•´ä½“éªŒè¯é€»è¾‘çš„ä¸€è‡´æ€§

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šPython/åç«¯+æ•°æ®å¤„ç† å…·ä½“æ¸…å•

### 4. Code Review æ£€æŸ¥ç‚¹

#### ğŸ” 4.1 å®‰å…¨æ€§ï¼ˆéåå•†é¡¹ï¼Œå¿…é¡»é€šè¿‡ï¼‰

- [ ] **SQL/æ•°æ®åº“** - æ˜¯å¦æœ‰ SQL æ³¨å…¥ã€N+1 æŸ¥è¯¢ã€ç¼ºå¤±ç´¢å¼•ã€æ•°æ®ç«æ€ï¼Ÿ
    
    ```python
    # âŒ å±é™©
    query = f"SELECT * FROM users WHERE id = {user_id}"
    
    # âœ… å®‰å…¨
    query = "SELECT * FROM users WHERE id = %s"
    cursor.execute(query, (user_id,))
    ```
    
- [ ] **è®¤è¯/æˆæƒ** - API æ˜¯å¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Ÿæ˜¯å¦æœ‰æƒé™æ£€æŸ¥ï¼Ÿ
    
    ```python
    # âŒ æ¼æ´
    def delete_user(user_id):
        User.objects.get(id=user_id).delete()
    
    # âœ… æ­£ç¡®
    def delete_user(user_id, current_user):
        if current_user.id != user_id and not current_user.is_admin:
            raise PermissionError()
        User.objects.get(id=user_id).delete()
    ```
    
- [ ] **å¯†ç /æ•æ„Ÿæ•°æ®** - å¯†ç æ˜¯å¦å“ˆå¸Œï¼Ÿæ•æ„Ÿæ•°æ®æ˜¯å¦åŠ å¯†ï¼Ÿæ—¥å¿—ä¸­æ˜¯å¦æš´éœ²å¯†é’¥ï¼Ÿ
    
    ```python
    # âŒ å±é™©
    password = request.POST['password']
    logger.info(f"User login: {password}")
    
    # âœ… æ­£ç¡®
    password_hash = hash_password(request.POST['password'])
    logger.info("User login attempt")  # ä¸è®°å½•å¯†ç 
    ```
    
- [ ] **é”™è¯¯å¤„ç†** - å¼‚å¸¸æ˜¯å¦è¢«æ•è·ï¼Ÿç”¨æˆ·æ˜¯å¦ä¼šçœ‹åˆ°æŠ€æœ¯æ ˆä¿¡æ¯ï¼Ÿ
    
    ```python
    # âŒ é—®é¢˜
    try:
        process_payment()
    except Exception as e:
        return f"Error: {e}"  # å¯èƒ½æš´éœ²å†…éƒ¨ä¿¡æ¯
    
    # âœ… æ­£ç¡®
    try:
        process_payment()
    except PaymentError as e:
        logger.error(f"Payment failed: {e}", exc_info=True)
        return "Payment processing failed. Please try again."
    ```
    

---

#### ğŸ” 4.2 æ•°æ®å¤„ç†ï¼ˆå¯¹ä½ ä»¬æœ€ç›¸å…³ï¼‰

- [ ] **æ•°æ®æ ¡éªŒ** - è¾“å…¥æ˜¯å¦éªŒè¯äº†ç±»å‹ã€èŒƒå›´ã€æ ¼å¼ï¼Ÿ
    
    ```python
    # âŒ ä¿¡ä»»ç”¨æˆ·è¾“å…¥
    def calculate_average(values):
        return sum(values) / len(values)
    
    # âœ… éªŒè¯è¾“å…¥
    def calculate_average(values):
        if not values or not all(isinstance(v, (int, float)) for v in values):
            raise ValueError("Input must be non-empty list of numbers")
        return sum(values) / len(values)
    ```
    
- [ ] **è¾¹ç•Œæƒ…å†µ** - ç©ºåˆ—è¡¨ã€Noneã€è´Ÿæ•°ã€è¶…å¤§å€¼ã€ç‰¹æ®Šå­—ç¬¦æ˜¯å¦å¤„ç†ï¼Ÿ
    
    ```python
    # âŒ æ¼æ´
    def process_data(df):
        return df['column'].mean()  # å¦‚æœ df ä¸ºç©ºä¼šå´©æºƒ
    
    # âœ… å®Œæ•´
    def process_data(df):
        if df.empty:
            return None
        return df['column'].mean()
    ```
    
- [ ] **æ•°æ®ä¸€è‡´æ€§** - äº‹åŠ¡æ˜¯å¦æ­£ç¡®ï¼Ÿå¹¶å‘å†™å…¥æ˜¯å¦æœ‰é”ï¼Ÿ
    
    ```python
    # âŒ ç«æ€æ¡ä»¶
    balance = account.balance
    account.balance = balance - amount
    account.save()
    
    # âœ… äº‹åŠ¡ä¿æŠ¤
    with transaction.atomic():
        account = Account.objects.select_for_update().get(id=id)
        account.balance -= amount
        account.save()
    ```
    
- [ ] **å†…å­˜æ•ˆç‡** - æ˜¯å¦æœ‰å†…å­˜æ³„æ¼ï¼Ÿå¤§æ•°æ®æ˜¯å¦ç”¨äº†æµå¼å¤„ç†è€Œéä¸€æ¬¡æ€§åŠ è½½ï¼Ÿ
    
    ```python
    # âŒ ä½æ•ˆï¼ˆåŠ è½½ 100 ä¸‡æ¡è®°å½•åˆ°å†…å­˜ï¼‰
    users = User.objects.all()
    for user in users:
        process(user)
    
    # âœ… é«˜æ•ˆï¼ˆåˆ†æ‰¹å¤„ç†ï¼‰
    User.objects.all().iterator(chunk_size=1000)
    ```
    
- [ ] **é‡å¤å¤„ç†** - æ•°æ®é‡å¤æ˜¯å¦ä¼šå¯¼è‡´ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼Ÿï¼ˆå¦‚å¹‚ç­‰æ€§ï¼‰
    
    ```python
    # âŒ ä¸å¹‚ç­‰
    def add_credit(user_id, amount):
        user.credit += amount
        user.save()
    
    # âœ… å¹‚ç­‰ï¼ˆå¯å®‰å…¨é‡è¯•ï¼‰
    def add_credit(user_id, amount, transaction_id):
        if Transaction.objects.filter(id=transaction_id).exists():
            return  # å·²å¤„ç†è¿‡
        user.credit += amount
        Transaction.objects.create(id=transaction_id, ...)
    ```
    

---

#### ğŸ” 4.3 æ€§èƒ½ï¼ˆåç«¯+æ•°æ®å¤„ç†å¿…çœ‹ï¼‰

- [ ] **æ•°æ®åº“æŸ¥è¯¢** - æ˜¯å¦æœ‰ N+1 é—®é¢˜ï¼Ÿæ˜¯å¦ç”¨äº† `select_related()`/`prefetch_related()`ï¼Ÿ
    
    ```python
    # âŒ N+1 æŸ¥è¯¢ï¼ˆ1 æ¬¡ä¸»æŸ¥è¯¢ + N æ¬¡å…³è”æŸ¥è¯¢ï¼‰
    posts = Post.objects.all()
    for post in posts:
        print(post.author.name)  # æ¯æ¬¡éƒ½æŸ¥ä¸€æ¬¡ author
    
    # âœ… é¢„åŠ è½½ï¼ˆ1 æ¬¡ä¸»æŸ¥è¯¢ + 1 æ¬¡å…³è”æŸ¥è¯¢ï¼‰
    posts = Post.objects.select_related('author')
    ```
    
- [ ] **ç¼“å­˜ç­–ç•¥** - æ˜¯å¦ç¼“å­˜äº†çƒ­æ•°æ®ï¼Ÿç¼“å­˜å¤±æ•ˆç­–ç•¥æ˜¯å¦æ¸…æ™°ï¼Ÿ
    
    ```python
    # âŒ æ²¡æœ‰ç¼“å­˜
    def get_user_posts(user_id):
        return Post.objects.filter(user_id=user_id)
    
    # âœ… æœ‰ç¼“å­˜å’Œå¤±æ•ˆé€»è¾‘
    def get_user_posts(user_id):
        cache_key = f"user_posts:{user_id}"
        posts = cache.get(cache_key)
        if posts is None:
            posts = Post.objects.filter(user_id=user_id)
            cache.set(cache_key, posts, timeout=3600)
        return posts
    
    # å‘å¸ƒæ–°å¸–æ—¶æ¸…ç¼“å­˜
    cache.delete(f"user_posts:{user_id}")
    ```
    
- [ ] **ç´¢å¼•** - é¢‘ç¹æŸ¥è¯¢çš„å­—æ®µæ˜¯å¦å»ºäº†ç´¢å¼•ï¼Ÿå¤åˆæŸ¥è¯¢æ˜¯å¦éœ€è¦å¤åˆç´¢å¼•ï¼Ÿ
    
- [ ] **å¼‚æ­¥ä»»åŠ¡** - æ˜¯å¦æŠŠé‡æ“ä½œï¼ˆé‚®ä»¶ã€æŠ¥å‘Šç”Ÿæˆã€æ•°æ®åŒæ­¥ï¼‰å¼‚æ­¥åŒ–äº†ï¼Ÿ
    
    ```python
    # âŒ åŒæ­¥ï¼ˆç”¨æˆ·ç­‰å¾… 10 ç§’ï¼‰
    send_email(user.email)
    return {"status": "sent"}
    
    # âœ… å¼‚æ­¥ï¼ˆç«‹åˆ»è¿”å›ï¼‰
    send_email.delay(user.email)
    return {"status": "queued"}
    ```
    

---

#### ğŸ” 4.4 å¯ç»´æŠ¤æ€§

- [ ] **å‘½åæ¸…æ™°** - å˜é‡ã€å‡½æ•°ã€ç±»åèƒ½å¦ä¸€çœ¼çœ‹å‡ºä½œç”¨ï¼Ÿ
    
    ```python
    # âŒ æ¨¡ç³Š
    result = process(data, 0.5)
    
    # âœ… æ¸…æ™°
    anomaly_score = calculate_anomaly_score(sensor_data, threshold=0.5)
    ```
    
- [ ] **å‡½æ•°èŒè´£å•ä¸€** - ä¸€ä¸ªå‡½æ•°æ˜¯å¦åšäº†å¤ªå¤šäº‹ï¼Ÿèƒ½å¦æ‹†æˆæ›´å°çš„å•ä½ï¼Ÿ
    
- [ ] **å¼‚å¸¸å¤„ç†** - æ˜¯å¦åŒºåˆ†äº†ä¸åŒçš„å¼‚å¸¸ç±»å‹ï¼Ÿ
    
    ```python
    # âŒ ç¬¼ç»Ÿ
    try:
        fetch_data()
    except:
        pass
    
    # âœ… å…·ä½“
    try:
        fetch_data()
    except requests.Timeout:
        logger.warning("Request timeout")
        # é‡è¯•æˆ–é™çº§
    except requests.RequestException as e:
        logger.error(f"Request failed: {e}")
        raise
    ```
    
- [ ] **ç±»å‹æ³¨è§£** - å…³é”®å‡½æ•°æ˜¯å¦æœ‰ç±»å‹æç¤ºï¼Ÿä¾¿äºç»´æŠ¤å’Œ IDE è¯†åˆ«ã€‚
    
    ```python
    # âŒ æ— ç±»å‹ä¿¡æ¯
    def calculate_discount(price, rate):
        return price * (1 - rate)
    
    # âœ… æœ‰ç±»å‹æ³¨è§£
    def calculate_discount(price: float, rate: float) -> float:
        return price * (1 - rate)
    ```
    
- [ ] **æ–‡æ¡£/æ³¨é‡Š** - å¤æ‚é€»è¾‘æ˜¯å¦æœ‰è¯´æ˜ï¼ŸAPI æ˜¯å¦æœ‰ docstringï¼Ÿ
    
    ```python
    # âœ… å¥½çš„ docstring
    def calculate_percentile(values: List[float], p: float) -> float:
        """
        è®¡ç®—ç™¾åˆ†ä½æ•°ï¼Œå¤„ç†ç©ºåˆ—è¡¨æƒ…å†µã€‚
        
        Args:
            values: æ•°å€¼åˆ—è¡¨
            p: ç™¾åˆ†ä½ï¼ˆ0-100ï¼‰
            
        Returns:
            ç™¾åˆ†ä½å¯¹åº”çš„å€¼ï¼Œç©ºåˆ—è¡¨è¿”å› None
            
        Example:
            >>> calculate_percentile([1, 2, 3, 4, 5], 50)
            3
        """
    ```
    

---

#### ğŸ” 4.5 æµ‹è¯•è¦†ç›–

- [ ] **å•å…ƒæµ‹è¯•** - å…³é”®å‡½æ•°æ˜¯å¦æœ‰å¯¹åº”çš„æµ‹è¯•ï¼Ÿè¾¹ç•Œæƒ…å†µæ˜¯å¦æµ‹è¿‡ï¼Ÿ
    
    ```python
    def test_calculate_average():
        # æ­£å¸¸æƒ…å†µ
        assert calculate_average([1, 2, 3]) == 2
        # è¾¹ç•Œæƒ…å†µ
        assert calculate_average([]) is None
        assert calculate_average([5]) == 5
        # å¼‚å¸¸æƒ…å†µ
        with pytest.raises(ValueError):
            calculate_average("not a list")
    ```
    
- [ ] **é›†æˆæµ‹è¯•** - æ•°æ®åº“æ“ä½œã€API è°ƒç”¨æ˜¯å¦æœ‰ç«¯åˆ°ç«¯æµ‹è¯•ï¼Ÿ
    
- [ ] **æµ‹è¯•å¯è¯»æ€§** - æµ‹è¯•åç§°æ˜¯å¦æ¸…æ¥šåœ°è¯´æ˜æµ‹è¯•ç›®çš„ï¼Ÿ
    

---

#### ğŸ” 4.6 é…ç½®ä¸éƒ¨ç½²

- [ ] **ç¡¬ç¼–ç ** - æ˜¯å¦æœ‰ç¡¬ç¼–ç çš„ API å¯†é’¥ã€URLã€å¯†ç ï¼Ÿåº”è¯¥ç”¨ç¯å¢ƒå˜é‡ã€‚
    
    ```python
    # âŒ ç¡¬ç¼–ç 
    db_url = "postgres://user:password@localhost/db"
    
    # âœ… ç¯å¢ƒå˜é‡
    db_url = os.getenv("DATABASE_URL")
    ```
    
- [ ] **ç‰ˆæœ¬å…¼å®¹** - æ˜¯å¦æ˜ç¡®äº† Python ç‰ˆæœ¬è¦æ±‚ï¼Ÿä¾èµ–æ˜¯å¦é”å®šäº†ç‰ˆæœ¬ï¼Ÿ
    
- [ ] **å‘åå…¼å®¹** - API æ”¹åŠ¨æ˜¯å¦ä¼šç ´åç°æœ‰å®¢æˆ·ç«¯ï¼Ÿæ˜¯å¦éœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ
    

---

### 5. è¯„è®ºæ¨¡æ¿ä¸ç¤ºä¾‹

#### ğŸ“ åœºæ™¯ 1ï¼šå‘ç° SQL æ³¨å…¥é£é™©

````
ğŸ›‘ MUST FIX

æˆ‘æ³¨æ„åˆ°è¿™é‡Œç›´æ¥å­—ç¬¦ä¸²æ‹¼æ¥äº† SQL æŸ¥è¯¢ï¼Œæœ‰æ³¨å…¥é£é™©ã€‚

å½“å‰ä»£ç ï¼š
```python
query = f"SELECT * FROM users WHERE email = '{email}'"
````

å»ºè®®æ”¹æˆå‚æ•°åŒ–æŸ¥è¯¢ï¼š

```python
query = "SELECT * FROM users WHERE email = %s"
cursor.execute(query, (email,))
```

è¿™æ ·å³ä½¿ email åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ `' OR '1'='1'`ï¼‰ï¼Œä¹Ÿä¼šè¢«æ­£ç¡®è½¬ä¹‰ï¼Œ

---

#### ğŸ“ åœºæ™¯ 2ï¼šN+1 æŸ¥è¯¢ä¼˜åŒ–

````
ğŸ’¡ SUGGESTION

è¿™æ®µä»£ç åœ¨å¤„ç†ç”¨æˆ·åŠå…¶è®¢å•æ—¶ï¼Œå¯¹æ¯ä¸ªç”¨æˆ·éƒ½æŸ¥äº†ä¸€æ¬¡è®¢å•ï¼Œå½¢æˆäº† N+1 é—®é¢˜ã€‚

å½“å‰é€»è¾‘ï¼ˆç¬¬ 45-50 è¡Œï¼‰ä¼šæ‰§è¡Œ 1 æ¬¡ä¸»æŸ¥è¯¢ + N æ¬¡å…³è”æŸ¥è¯¢ï¼ˆN ä¸ºç”¨æˆ·æ•°ï¼‰ã€‚

å»ºè®®ç”¨ `select_related()` é¢„åŠ è½½ï¼š
```python
users = User.objects.select_related('profile').all()
for user in users:
    print(user.profile.bio)  # ç°åœ¨ä¸ä¼šå†æŸ¥æ•°æ®åº“
````

å¦‚æœæ˜¯åå‘å…³ç³»ï¼ˆä¸€å¯¹å¤šï¼‰ï¼Œç”¨ `prefetch_related()`ï¼š

```python
users = User.objects.prefetch_related('posts').all()
for user in users:
    for post in user.posts.all():  # é¢„åŠ è½½äº†æ‰€æœ‰ posts
        print(post.title)
```

è¿™èƒ½æŠŠæŸ¥è¯¢æ¬¡æ•°ä» N+1 é™åˆ° 2 æ¬¡ã€‚å¯¹å¤§æ•°æ®é‡ä¼šæœ‰æ˜æ˜¾æ€§èƒ½æå‡ã€‚

```

---

#### ğŸ“ åœºæ™¯ 3ï¼šè¾¹ç•Œæƒ…å†µå¤„ç†ä¸å®Œæ•´

```

â“ QUESTION + ğŸ’¡ SUGGESTION

æˆ‘åœ¨çœ‹è¿™ä¸ªå¹³å‡å€¼è®¡ç®—å‡½æ•°ï¼ˆç¬¬ 78 è¡Œï¼‰ï¼Œæƒ³ç¡®è®¤ä¸€ä¸‹è¾¹ç•Œæƒ…å†µï¼š

1. å¦‚æœä¼ å…¥ç©ºåˆ—è¡¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç°åœ¨ä»£ç ä¼šè§¦å‘ `ZeroDivisionError`ã€‚
2. å¦‚æœåˆ—è¡¨ä¸­æœ‰ `None` å€¼å‘¢ï¼Ÿ

å»ºè®®åŠ ä¸ªéªŒè¯ï¼š

```python
def calculate_average(values: List[float]) -> Optional[float]:
    """è®¡ç®—å¹³å‡å€¼ï¼Œç©ºåˆ—è¡¨è¿”å› Noneã€‚"""
    if not values:
        return None
    
    # è¿‡æ»¤æ‰ None å€¼
    valid_values = [v for v in values if v is not None]
    if not valid_values:
        return None
    
    return sum(valid_values) / len(valid_values)
```

æˆ–è€…ï¼Œå¦‚æœä½ è®¤ä¸ºä¼ å…¥æ— æ•ˆæ•°æ®å°±åº”è¯¥æŠ›é”™ï¼Œä¹Ÿå¯ä»¥ç”¨ assertï¼š

```python
assert values, "values cannot be empty"
assert all(isinstance(v, (int, float)) for v in values), "all values must be numbers"
```

ä½ å€¾å‘å“ªä¸ªå¤„ç†æ–¹å¼ï¼Ÿ

```

---

#### ğŸ“ åœºæ™¯ 4ï¼šä»£ç é‡å¤ï¼Œå»ºè®®æå–

```

ğŸ’¡ SUGGESTION

æˆ‘çœ‹åˆ°ç¬¬ 120-140 è¡Œå’Œç¬¬ 200-220 è¡Œæœ‰ç›¸ä¼¼çš„æ•°æ®éªŒè¯é€»è¾‘ã€‚ éƒ½åœ¨åšï¼šæ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨ â†’ ç±»å‹è½¬æ¢ â†’ èŒƒå›´æ£€æŸ¥ã€‚

å»ºè®®æå–æˆä¸€ä¸ª helper å‡½æ•°ï¼š

```python
def validate_and_convert(value, field_name, expected_type, min_val=None, max_val=None):
    """éªŒè¯å’Œè½¬æ¢å•ä¸ªå­—æ®µã€‚"""
    if value is None:
        raise ValueError(f"{field_name} is required")
    
    try:
        converted = expected_type(value)
    except (TypeError, ValueError):
        raise ValueError(f"{field_name} must be {expected_type.__name__}")
    
    if min_val is not None and converted < min_val:
        raise ValueError(f"{field_name} must be >= {min_val}")
    if max_val is not None and converted > max_val:
        raise ValueError(f"{field_name} must be <= {max_val}")
    
    return converted
```

è¿™æ ·ä»£ç ä¼šæ›´ DRYï¼Œä¹Ÿæ–¹ä¾¿åç»­ç»´æŠ¤å’Œå•å…ƒæµ‹è¯•ã€‚

```

---

#### ğŸ“ åœºæ™¯ 5ï¼šèµåŒ + å°å»ºè®®

```

ğŸ‘ Nice work!

æˆ‘å–œæ¬¢ä½ å¯¹å¼‚å¸¸è¿›è¡Œäº†åˆ†ç±»å¤„ç†ï¼Œè¿™æ ·å¯ä»¥å¯¹ä¸åŒé”™è¯¯é‡‡å–ä¸åŒçš„æ¢å¤ç­–ç•¥ã€‚

ä¸€ä¸ªå°å»ºè®®ï¼šåœ¨ `NetworkError` å¼‚å¸¸æ—¶ï¼Œå¯ä»¥åŠ ä¸ªé‡è¯•é€»è¾‘å—ï¼Ÿ ç‰¹åˆ«æ˜¯å¯¹äºæ•°æ®åŒæ­¥è¿™ç§å¯èƒ½å› ä¸ºç½‘ç»œæ³¢åŠ¨å¤±è´¥çš„æ“ä½œï¼š

```python
@retry(max_attempts=3, backoff=exponential)
def sync_external_data():
    try:
        fetch_data()
    except NetworkError:
        logger.warning("Network error, will retry")
        raise  # è®© @retry è£…é¥°å™¨å¤„ç†é‡è¯•
    except DataValidationError:
        logger.error("Data validation failed, not retrying")
        # è¿™ä¸ªé”™è¯¯ä¸è¯¥é‡è¯•ï¼Œéœ€è¦äººå·¥å®¡æŸ¥
```

ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†è¿™æ ·å¯¹ç”Ÿäº§ç¯ä¿ä¼šæ›´å‹å¥½ã€‚

```

---

### 6. å¸¸è§åé¢ç¤ºä¾‹ï¼ˆé¿å…è¿™æ ·åšï¼‰

#### âŒ åé¢ä¾‹ 1ï¼šå‘½ä»¤å¼ä¸”ç¼ºä¹è§£é‡Š
```

"è¿™é‡Œæ”¹æˆ async/awaitã€‚"

```
âœ… æ”¹è¿›ï¼š
```

"æˆ‘çœ‹è¿™ä¸ªå‡½æ•°åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸ŠèŠ±äº†å¤§é‡æ—¶é—´ï¼Œç”¨ async/await å¯ä»¥åœ¨ I/O ç­‰å¾…æœŸé—´å¤„ç†å…¶ä»–è¯·æ±‚ã€‚ Python 3.7+ å¯ä»¥ç”¨åŸç”Ÿ asyncï¼Œæœ‰è€ƒè™‘è¿‡å—ï¼Ÿ"

```

---

#### âŒ åé¢ä¾‹ 2ï¼šç¬¼ç»Ÿçš„æ‰¹è¯„
```

"è¿™ä¸ªä»£ç è´¨é‡å¤ªä½ã€‚"

```
âœ… æ”¹è¿›ï¼š
```

"æˆ‘æ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°æœ‰ä¸‰å±‚åµŒå¥— ifï¼Œé€»è¾‘æ¯”è¾ƒå¤æ‚ã€‚èƒ½ç”¨å«è¯­å¥ï¼ˆguard clauseï¼‰æ¥æ‰å¹³åŒ–å—ï¼Ÿ è¿™æ ·ä¹Ÿæ›´å®¹æ˜“æµ‹è¯•ã€‚"

```

---

#### âŒ åé¢ä¾‹ 3ï¼šåªæœ‰é—®é¢˜ï¼Œæ²¡æœ‰å»ºè®®
```

"ä¸ºä»€ä¹ˆç”¨è¿™ä¸ªç®—æ³•ï¼Ÿ"

```
âœ… æ”¹è¿›ï¼š
```

"æˆ‘å¥½å¥‡ä¸ºä»€ä¹ˆè¿™é‡Œé€‰æ‹©äº† BFS è€Œä¸æ˜¯ DFSï¼ŸBFS çš„å†…å­˜å¼€é”€ä¼šæ¯”è¾ƒå¤§ï¼Œ å¯¹äºè¿™ä¸ªåœºæ™¯æœ‰ä»€ä¹ˆç‰¹åˆ«çš„è€ƒè™‘å—ï¼Ÿ"

```

---

#### âŒ åé¢ä¾‹ 4ï¼šæŠŠåå¥½å½“æˆé—®é¢˜
```

"å˜é‡ååº”è¯¥æ›´çŸ­ï¼Œä½ è¿™ä¸ªå¤ªå•°å—¦äº†ã€‚"

```
âœ… æ”¹è¿›ï¼š
```

"è¿™ä¸ªå˜é‡åæœ‰ç‚¹é•¿ï¼Œæ•´è¡Œä»£ç è¶…è¿‡äº† 88 å­—ç¬¦ã€‚èƒ½ç®€åŒ–ä¸€ä¸‹å—ï¼Ÿ æ¯”å¦‚ `user_registration_timestamp` å¯ä»¥ç¼©çŸ­æˆ `reg_time`ï¼Ÿ"

````

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæµç¨‹ä¸æ–‡åŒ–

### 7. å»ºç«‹è‰¯å¥½çš„ CR æ–‡åŒ–

#### ğŸŒ± 7.1 Code Review çš„ä¸‰ä¸ªé˜¶æ®µ

**ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2 å‘¨ï¼‰ï¼šå»ºç«‹è§„èŒƒæ„è¯†**
- åˆ†äº«è¿™ä»½æ‰‹å†Œç»™å…¨å›¢é˜Ÿ
- åœ¨æ¯æ¬¡ CR ä¸­ä¸»åŠ¨ç¤ºèŒƒ"å¥½çš„è¯„è®ºé£æ ¼"
- å¦‚æœçœ‹åˆ°ä¸å¥½çš„è¯„è®ºï¼Œæ¸©å’Œåœ°æé†’æˆ–ç¤ºèŒƒæ”¹è¿›æ–¹å¼

**ç¬¬äºŒé˜¶æ®µï¼ˆ2-4 å‘¨ï¼‰ï¼šå†…åŒ–æˆä¹ æƒ¯**
- å¤§å¤šæ•°è¯„è®ºå¼€å§‹éµå¾ªè§„èŒƒ
- æ–°æˆå‘˜èƒ½ä»æ—¢æœ‰è¯„è®ºä¸­å­¦ä¹ é£æ ¼
- è‡ªç„¶å‡ºç°"äº’ç›¸çº æ­£"çš„å¥åº·åé¦ˆ

**ç¬¬ä¸‰é˜¶æ®µï¼ˆ1 ä¸ªæœˆ+ï¼‰ï¼šæ–‡åŒ–è‡ªæˆ‘å¼ºåŒ–**
- è§„èŒƒæˆä¸ºå›¢é˜Ÿçš„é»˜è®¤è¡Œä¸º
- å¶å°”æœ‰ä¸è§„èŒƒçš„è¯„è®ºä¼šè¢«ä¸»åŠ¨æ”¹è¿›
- æ–°æˆå‘˜å…¥èŒæ—¶ï¼Œèƒ½ä»ä»£ç åº“ä¸­è‡ªç„¶å­¦ä¼šè¿™å¥—é£æ ¼

---

#### ğŸŒ± 7.2 å¼€æ”¾åé¦ˆçš„æœºåˆ¶

**æ¯å‘¨ä¸€æ¬¡"CR å›é¡¾ä¼š"ï¼ˆ15 åˆ†é’Ÿï¼‰**
- è½®æµåˆ†äº«é‚£å‘¨åšå¾—å¥½çš„ CR ä¾‹å­
- ä¹Ÿå¯ä»¥è¯´"æˆ‘è¿™å‘¨çš„è¯„è®ºæœ‰ç‚¹ç”Ÿç¡¬ï¼Œä¸‹æ¬¡æ”¹è¿›"
- è¥é€ å¿ƒç†å®‰å…¨çš„æ°›å›´

**åœ¨ GitHub PR ä¸Šè®¾ç½®æ£€æŸ¥æ¸…å•**
```markdown
## Code Review Checklist

### è¯„è®ºæ–¹å¼
- [ ] æˆ‘ç”¨äº†"æˆ‘è®¤ä¸º"è€Œé"ä½ åº”è¯¥"
- [ ] æˆ‘è§£é‡Šäº† WHYï¼Œè€Œä¸ä»…æ˜¯ WHAT
- [ ] æˆ‘åŒºåˆ†äº†"å¿…é¡»æ”¹"å’Œ"å»ºè®®"
- [ ] å¦‚æœå‘ç°é—®é¢˜ï¼Œæˆ‘æä¾›äº†ç¤ºä¾‹

### ä»£ç è´¨é‡
- [ ] æ²¡æœ‰ SQL æ³¨å…¥ã€æ•°æ®ç«æ€ç­‰å®‰å…¨é—®é¢˜
- [ ] è¾¹ç•Œæƒ…å†µéƒ½å¤„ç†äº†
- [ ] æœ‰é€‚å½“çš„æµ‹è¯•
- [ ] æ–‡æ¡£/æ³¨é‡Šæ¸…æ™°
````

---

#### ğŸŒ± 7.3 ç»™æ–° reviewer çš„å…¥é—¨

å¦‚æœæœ‰èµ„æ·±å·¥ç¨‹å¸ˆæ˜¯ç¬¬ä¸€æ¬¡åš CRï¼Œå»ºè®®ï¼š

1. å…ˆå¯¹è‡ªå·±ä¸¥æ ¼ï¼šåœ¨æäº¤è¯„è®ºå‰ï¼Œè¯»ä¸€éè¿™ä»½æ‰‹å†Œ
2. å‚è€ƒç°æœ‰çš„"å¥½è¯„è®º"ï¼šGitHub æœç´¢ `is:pr is:merged label:reviewed` çœ‹çœ‹é˜Ÿå‹çš„é£æ ¼
3. å†™å®Œè¯„è®ºï¼Œåœé¡¿ 5 ç§’ï¼Œé—®è‡ªå·±ï¼š"å¦‚æœæˆ‘æ˜¯ PR ä½œè€…ï¼Œæˆ‘æ˜¯å¦æ„Ÿåˆ°è¢«å°Šé‡ï¼Ÿ"

---

## ç¬¬å››éƒ¨åˆ†ï¼šGitHub å·¥ä½œæµé…ç½®

### 8. PR æ¨¡æ¿ï¼ˆä¿å­˜ä¸º `.github/pull_request_template.md`ï¼‰

```markdown
## ğŸ“‹ PR æè¿°

ç®€è¦è¯´æ˜è¿™ä¸ª PR çš„ç›®çš„å’Œæ”¹åŠ¨å†…å®¹ã€‚

### é—®é¢˜èƒŒæ™¯
è¿™ä¸ªåŠŸèƒ½/ä¿®å¤è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ

### è§£å†³æ–¹æ¡ˆ
æ€æ ·è§£å†³çš„ï¼ŸæŠ€æœ¯æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ

### æµ‹è¯•æ–¹æ³•
æ€æ ·éªŒè¯æ”¹åŠ¨æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡ï¼ˆå¦‚é€‚ç”¨ï¼‰

### å¯¹ç°æœ‰åŠŸèƒ½çš„å½±å“
ä¼šä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ï¼Ÿæ˜¯å¦éœ€è¦æ•°æ®è¿ç§»ï¼Ÿ

### å®¡æŸ¥é‡ç‚¹
æŒ‡å¯¼ reviewer å…³æ³¨ä»€ä¹ˆåœ°æ–¹ï¼Œæ¯”å¦‚ï¼š
- "é‡ç‚¹çœ‹ç¬¬ 45 è¡Œçš„æ•°æ®éªŒè¯é€»è¾‘"
- "è¿™é‡Œæ”¹äº† API ç­¾åï¼Œå¯èƒ½æœ‰å‘åå…¼å®¹æ€§é—®é¢˜ï¼Œéº»çƒ¦é‡ç‚¹å…³æ³¨"

---

## è¯„è®ºé£æ ¼æŒ‡å—

äº²çˆ±çš„ reviewersï¼Œè¯·å‚è€ƒ [Code Review ç¤¼ä»ªè§„èŒƒ](link)ï¼Œç‰¹åˆ«æ˜¯ï¼š
- âœ… ç”¨"æˆ‘è®¤ä¸º"è€Œé"ä½ åº”è¯¥"
- âœ… è§£é‡Š WHYï¼Œè€Œä¸ä»…æ˜¯ WHAT
- âœ… åŒºåˆ†"ğŸ›‘ å¿…é¡»æ”¹"ä¸"ğŸ’¡ å»ºè®®"
```

---

### 9. Reviewer æ£€æŸ¥æ¸…å•ï¼ˆGitHub çš„ Review Templateï¼‰

åœ¨é¡¹ç›®è®¾ç½®ä¸­å¯ç”¨ "Code review assignment"ï¼Œå¹¶åˆ›å»º `.github/CODEOWNERS` æ–‡ä»¶ï¼š

```
# è‡ªåŠ¨åˆ†é… reviewer
*.py @senior-engineer-1 @senior-engineer-2
tests/ @qa-engineer
docs/ @tech-lead
```

---

### 10. è‡ªåŠ¨åŒ–è¾…åŠ©ï¼ˆå¯é€‰ï¼‰

#### ç”¨ pre-commit hooks å‡å°‘ review ä¸­çš„å°äº‹

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.1.0
    hooks:
      - id: black
  
  - repo: https://github.com/PyCQA/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
  
  - repo: https://github.com/PyCQA/isort
    rev: 5.12.0
    hooks:
      - id: isort
```

**å¥½å¤„**ï¼šä»£ç æ ¼å¼å’Œ lint é”™è¯¯åœ¨æäº¤å‰å·²è‡ªåŠ¨ä¿®å¤ï¼Œreview å¯ä»¥ä¸“æ³¨äºé€»è¾‘å’Œè®¾è®¡ã€‚

---

## æ€»ç»“é€ŸæŸ¥è¡¨

|ç»´åº¦|âŒ é¿å…|âœ… æ¨è|
|---|---|---|
|**è¯­æ°”**|"ä½ è¿™æ ·å†™é”™äº†"|"æˆ‘è§‰å¾—è¿™é‡Œå¯ä»¥ä¼˜åŒ–"|
|**æ·±åº¦**|åªè¯´"ä¸è¡Œ"|è§£é‡ŠåŸå›  + æä¾›ç¤ºä¾‹|
|**æ€åº¦**|æŒ‡è´£ã€å±•ç¤ºæƒå¨|å°Šé‡ã€å¹³ç­‰å¯¹è¯|
|**æ ‡è®°**|å«æ··çš„è¯„è®º|ğŸ›‘ MUST / ğŸ’¡ SUGGESTION / â“ QUESTION|
|**å¤„ç†é‡**|ä¸€æ¬¡æ€§ 10+ ä¸ªè¯„è®º|æŒ‰ä¼˜å…ˆçº§åˆ†ç»„|
|**æµç¨‹**|Review åä¸æ²Ÿé€š|Review åè·Ÿè¿›è®¨è®ºï¼Œç¡®ä¿æ”¹è¿›è¢«ç†è§£|

---

## å¸¸è§é—®é¢˜

**Qï¼šå¦‚æœ PR ä½œè€…ä¸åŒæ„æˆ‘çš„å»ºè®®æ€ä¹ˆåŠï¼Ÿ**  
Aï¼šè¿™å¾ˆæ­£å¸¸ã€‚é‡ç‚¹ä¸æ˜¯"èµ¢"ï¼Œè€Œæ˜¯è¾¾æˆå…±è¯†ã€‚å¯ä»¥è¿™æ ·ï¼š

- "æˆ‘çš„è€ƒè™‘æ˜¯ Xï¼Œä½†ä½ çš„ç†ç”± Y ä¹Ÿæœ‰é“ç†ã€‚è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆã€‚"
- å¿…è¦æ—¶çº¦ä¸ª 1v1 è®¨è®ºã€‚

**Qï¼šå¦‚æœ PR å¤ªå¤§ï¼Œæ€æ ·é«˜æ•ˆ reviewï¼Ÿ**  
Aï¼š

- ç¤¼è²Œåœ°è¦æ±‚åˆ†å‰²æˆæ›´å°çš„ PR
- å¦‚æœéå¾—ä¸€æ¬¡æ€§ reviewï¼Œå…ˆçœ‹ diff ç»Ÿè®¡å’Œ PR æè¿°ï¼Œç†è§£å…¨å±€é€»è¾‘ï¼Œå†æŒ‰æ¨¡å—æ·±è¯»

**Qï¼šå‘ç°äº†ä¸¥é‡é—®é¢˜ä½†ä¸æƒ³ç ´åä½œè€…çš„å¿ƒæƒ…ï¼Œæ€ä¹ˆè¯´ï¼Ÿ**  
Aï¼šç›´æ¥è¯´ï¼Œä½†è¦å°Šé‡ï¼š

```
"è¿™ä¸ªé€»è¾‘æœ‰ä¸ªé—®é¢˜æˆ‘ä»¬éœ€è¦è§£å†³â€”â€”å¹¶å‘å†™å…¥æ—¶ä¼šäº§ç”Ÿç«æ€æ¡ä»¶ã€‚
æˆ‘çŸ¥é“è¿™éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬ä¸€èµ·è°ƒè¯•ï¼Ÿæˆ‘çœ‹ä½ çš„æ€è·¯å¾ˆæ¸…æ™°ï¼Œ
ä¸€æ—¦åŠ ä¸Šäº‹åŠ¡ä¿æŠ¤åº”è¯¥å°±æ²¡é—®é¢˜äº†ã€‚"
```

---

## å‚è€ƒèµ„æº

- **Google Code Review æŒ‡å—**ï¼šhttps://google.github.io/eng-practices/review/
- **Python PEP 8 è§„èŒƒ**ï¼šhttps://pep8.org/
- **Django æœ€ä½³å®è·µ**ï¼šhttps://docs.djangoproject.com/
- **PostgreSQL æ€§èƒ½ä¼˜åŒ–**ï¼šhttps://wiki.postgresql.org/wiki/Performance_Optimization

</parameter>