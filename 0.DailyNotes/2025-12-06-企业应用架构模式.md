---
view-count: 6
tags:
  - concept/architecture
  - moc/tech
  - domain/engineering
status: evergreen
aliases:
  - 架构风格
  - Architectural Paradigms
update: 2026-01-07 11:19
related:
  - "[[软件架构设计]]"
  - "[[2025-12-06-企业应用架构模式]]"
  - "[[2025-12-07-系统架构分类框架]]"
  - "[[Real World Case Studies]]"
---
# [[2025-12-06-企业应用架构模式]]：极简版

## 核心公式
**简单逻辑 = 事务脚本 (Transaction Script)**
**复杂业务 = 领域模型 (Domain Model)**
**数据同步 = 工作单元 (Unit of Work) + 映射器 (Mapper)**

---

## 1. 业务逻辑组织

| 模式 | 定义 | 适用场景 |
|:--- |:--- |:--- |
| **事务脚本** | 一个过程处理一个请求。 | 逻辑简单、快速交付。 |
| **领域模型** | 富对象封装状态与行为。 | 业务极其复杂、需长期维护。 |
| **表模块** | 一个类处理一张表的所有逻辑。 | 介于脚本与模型之间。 |
| **服务层** | 定义应用的边界与逻辑入口。 | 解耦表现层，微服务 API 雏形。 |

---

## 2. 数据源桥接 (ORM 核心)

- **Data Mapper |** 对象与数据库完全解耦（MyBatis/Hibernate 模式）。*现代主流。*
- **Active Record |** 对象自带 CRUD 逻辑（Rails/PHP 常用）。*适合简单 CRUD。*
- **Repository |** 将数据库伪装成内存集合。*DDD 核心。*
- **Unit of Work |** 维护变更清单，一次性提交事务。*减少 DB 往返。*
- **Identity Map |** 确保同一 ID 在内存中只有一个实例。*防止数据冲突。*

---

## 3. 并发与解耦工具

### I. 并发控制
- **乐观锁 |** 依靠版本号 ($@Version$)。适用于冲突少的场景。
- **悲观锁 |** 依靠数据库行锁 ($SELECT\ FOR\ UPDATE$)。适用于关键金额扣减。

### II. 数据流转
- **DTO |** 跨进程传输的纯数据包。防止暴露领域模型内部细节。
- **Value Object |** 无身份、不可变的描述性对象（如 Money 类，解决浮点误差）。
- **Separated Interface |** 接口与实现分离，支持插件化扩展。

---

## 4. 架构诊断三步法

1. **评估复杂度 |** 如果 $if-else$ 超过三层且多处重复，立即从脚本转向模型。
2. **定义分层 |** 确保表现层不写 SQL，领域层不处理 HTTP 请求。
3. **选择映射器 |** 追求极致解耦选 Data Mapper；追求极速开发选 Active Record。

---

## 5. 实践自检
- [ ] 核心业务是否被“贫血模型”（只有 getter/setter）架空？
- [ ] 关联对象是否使用了 **Lazy Load**（延迟加载）以优化性能？
- [ ] 跨团队接口是否使用了 **DTO** 进行隔离？

---

## 黄金法则
**不要为了架构而架构：逻辑简单时，脚本就是最高效的模式。**

---
**关联笔记：** [[2025-12-07-系统架构分类框架]] | [[2025-12-05-Python学习套件]]

# 架构范式：系统边界与解耦策略

## 1. 核心逻辑：复杂度与自治的权衡

架构设计的本质是**划定边界**。边界越清晰，系统自治性越高，但通信与运维复杂度呈指数级增加。

## 2. 范式决策矩阵 (Decision Matrix)

| 范式                | 核心机制         | 耦合度 | 运维成本 | 核心 ROI 洞察                           |
| :---------------- | :----------- | :-- | :--- | :---------------------------------- |
| **单体 (Monolith)** | 单进程、共享数据库    | 极高  | 极低   | **速度之王**。适合 MVP 或 10 人以下团队，避免过度设计。  |
| **SOA**           | ESB 总线、粗粒度服务 | 中等  | 高    | **集成方案**。适用于整合异构遗留系统，ESB 是潜在瓶颈。     |
| **微服务 (Micro)**   | 独立部署、API 通信  | 低   | 极高   | **扩展之王**。解决组织架构匹配问题，需强大的 DevOps 支撑。 |
| **事件驱动 (EDA)**    | 异步消息、Pub/Sub | 极低  | 中高   | **响应之王**。实现物理/时间双重解耦，适合高并发、实时流。     |

## 3. 场景触发指南 (Scenario Triggers)

- **场景 A：业务验证期 / 资源有限**
  - *选择*：**单体架构**。
  - *理由*：零网络延迟，部署代价极小，代码重构门槛低。
- **场景 B：多团队协作 / 独立发布需求**
  - *选择*：**微服务架构**。
  - *理由*：通过 API 契约解耦团队进度，支持针对性水平扩展（如只扩展支付模块）。
- **场景 C：高频异步处理 / 实时数据流**
  - *选择*：**事件驱动 (EDA)**。
  - *理由*：利用 MQ（Kafka/RabbitMQ）削峰填谷，生产者无需关心消费者状态。
- **场景 D：多系统异构整合**
  - *选择*：**SOA**。
  - *理由*：利用服务总线抹平协议差异（SOAP/REST/RPC）。

## 4. 演进原则 (Evolutionary Protocol)

不要跳步。**单体应用 -> 模块化单体 -> 微服务/EDA** 是风险最低的路径。

- **拆分信号**：编译时间超过 10 分钟；代码冲突无法通过沟通解决；单点流量激增导致全站瘫痪。

**关联笔记**

- [[2025-12-31-系统设计与架构模式]]
