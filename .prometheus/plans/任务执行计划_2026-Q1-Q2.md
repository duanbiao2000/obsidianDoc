# 知识库优化任务执行计划

> 基于优化线路图 v3 (CFA 原则) 的详细任务清单
> 创建时间: 2026-01-26
> 规划周期: 2026 Q1 - Q2

---

## 📋 目录

- [M0: 现有资产审查](#m0-现有资产审查)
- [Milestone 1: The Healthy Core](#milestone-1-the-healthy-core)
- [Milestone 2: The Agentic Engine](#milestone-2-the-agentic-engine)
- [Milestone 3: Cognitive Augmentation](#milestone-3-cognitive-augmentation)

---

## M0: 现有资产审查

### 目标
审查已完成的优化工作，评估其与新里程碑的契合度，决定保留、调整或废弃。

### 任务清单

#### M0-1: 资产映射与评估 ✅

**已完成工作回顾**:

| 已完成项目 | 与新里程碑的契合度 | 处理决定 |
|:-----------|:------------------|:---------|
| **CLAUDE.md 文档体系** | 🟡 部分契合 M1 | ✅ **保留** - 为 Agent 提供系统理解 |
| **NotebookLM 深度集成** | 🟢 直接契合 M2 | ✅ **保留** - 作为深度研究工作流基础 |
| **标签质量评分机制** | 🟡 部分契合 M1 | 🔄 **重构** - 简化为 Schema 验证工具 |
| **标签推荐系统** | 🟢 直接契合 M1/M2 | ✅ **保留** - 作为 Smart Tagger v1 |
| **健康监控脚本** | 🟢 直接契合 M1 | ✅ **保留** - 作为 Linter 基础 |

**结论**:
- 保留 80% 已完成工作
- 需要重构 20% 以符合新的 IS/IS NOT 边界

---

## Milestone 1: The Healthy Core (Data Readiness)

**时间框**: 2026年 2月 (4周)
**核心目标**: 数据标准化，为 AI 高保真读取做准备

### IS/IS NOT 边界

| 维度 | ✅ IS (做什么) | ❌ IS NOT (不做什么) |
|:-----|:---------------|:---------------------|
| **范围** | Schema 强制执行: 定义严格的 YAML Frontmatter 规范 | 内容重写: 不重写笔记正文内容 |
| **自动化** | Linting 检查: 自动化检查与修复脚本 | 人工打标: 不手动为 1000+ 文件打标签 |
| **验收标准** | 机器可读性: 100% Active 状态笔记可被脚本无误解析 | 人类审美: 不为"知识图谱好看"而优化 |

---

### 任务分解

#### M1-1: 设计 Metadata Schema v1

**目标**: 定义核心元数据标准，确保机器可读性

**子任务**:

- [ ] **M1-1.1**: 分析现有元数据模式
  - 扫描 1000+ 文件提取元数据模式
  - 识别常用字段和取值范围
  - 生成元数据使用统计报告

- [ ] **M1-1.2**: 定义核心字段规范
  ```yaml
  # 必填字段 (Required)
  - tags: [三层标签体系: Domain/Status/Type]
  - created: ISO 8601 日期
  - modified: ISO 8601 日期

  # 推荐字段 (Recommended)
  - related: [相关笔记链接]
  - status: TODO/InProgress/Review/Done
  - rating: 0-5 浮点数

  # 可选字段 (Optional)
  - update: weekly/monthly/quarterly
  - view-count: 整数
  - complexity: Low/Medium/High
  ```

- [ ] **M1-1.3**: 编写 JSON Schema 验证文件
  ```json
  {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Obsidian Note Metadata Schema v1",
    "type": "object",
    "required": ["tags", "created", "modified"],
    "properties": {
      "tags": {
        "type": "array",
        "minItems": 3,
        "maxItems": 12
      },
      "created": {
        "type": "string",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
      }
    }
  }
  ```

- [ ] **M1-1.4**: 编写 Schema 文档
  - 创建 `Atlas/BASE/Metadata_Schema_v1.md`
  - 包含字段说明、示例、最佳实践
  - 提供迁移指南

**交付物**:
- ✅ `metadata_schema_v1.json`
- ✅ `Atlas/BASE/Metadata_Schema_v1.md`
- ✅ 元数据使用统计报告

**验收标准**:
- [ ] Schema 覆盖 90% 的常用元数据字段
- [ ] 可通过 JSON Schema Validator 验证
- [ ] 文档包含 5+ 个实际示例

---

#### M1-2: 开发 Vault Linter 原型

**目标**: 自动化元数据检查与修复工具

**子任务**:

- [ ] **M1-2.1**: 设计 Linter 架构
  ```
  vault_linter.py
  ├── core/
  │   ├── schema_validator.py   # Schema 验证
  │   ├── tag_analyzer.py        # 标签分析
  │   └── link_checker.py        # 链接检查
  ├── fixers/
  │   ├── metadata_fixer.py      # 元数据修复
  │   ├── tag_normalizer.py      # 标签规范化
  │   └── date_formatter.py      # 日期格式化
  └── reporters/
      ├── console_reporter.py    # 控制台输出
      └── html_reporter.py       # HTML 报告
  ```

- [ ] **M1-2.2**: 实现核心验证功能
  - ✅ 复用现有 `vault_health_monitor.py` 的扫描逻辑
  - 实现 JSON Schema 验证
  - 添加标签规范性检查
  - 实现元数据完整性检查

- [ ] **M1-2.3**: 实现自动修复功能
  - **安全修复**:
    - 日期格式标准化
    - 标签顺序调整
    - 空字段填充默认值
  - **交互式修复**:
    - 缺失必填字段时提示用户
    - 可疑标签建议替换
    - 需要人工确认的修复

- [ ] **M1-2.4**: 性能优化
  - 增量扫描 (仅检查修改的文件)
  - 并行处理 (多线程/多进程)
  - 缓存机制 (避免重复验证)

- [ ] **M1-2.5**: 集成到工作流
  - Git Pre-commit Hook
  - Obsidian 插件 (Linter 插件配置)
  - 定时任务 (Cron/Job Scheduler)

**交付物**:
- ✅ `5.Misc/Template/Scripts/vault_linter.py`
- ✅ Git Hook 配置文件
- ✅ 使用文档和示例

**验收标准**:
- [ ] 扫描速度 < 10秒/1000文件
- [ ] 误报率 < 5%
- [ ] 支持增量扫描

---

#### M1-3: 创建实时健康度看板

**目标**: 可视化展示知识库健康状态

**子任务**:

- [ ] **M1-3.1**: 设计健康度指标体系
  ```
  一级指标:
  ├── Schema 合规率
  │   ├── 必填字段完整性
  │   ├── 标签规范性
  │   └── 日期格式正确性
  ├── 内容健康度
  │   ├── 孤立笔记比例
  │   ├── 平均链接密度
  │   └── 空笔记数量
  └── 系统健康度
      ├── 索引覆盖率
      ├── 断链数量
      └── 文件大小分布
  ```

- [ ] **M1-3.2**: 实现 Dataview 查询
  ```dataview
  ## Schema 合规率
  ```dataviewjs
  const notes = dv.pages().where(p => p.file.size > 0);
  const compliant = notes.where(p => p.tags && p.tags.length >= 3);
  const rate = compliant.length / notes.length * 100;
  dv.paragraph(`合规率: ${rate.toFixed(1)}% (${compliant.length}/${notes.length})`);
  ```
  ```

- [ ] **M1-3.3**: 创建可视化组件
  - 进度条 (合规率)
  - 趋势图 (历史变化)
  - 热力图 (问题分布)
  - 排行榜 (Top 10 问题)

- [ ] **M1-3.4**: 建立预警机制
  - 🔴 红色: 合规率 < 70%
  - 🟡 黄色: 合规率 70-90%
  - 🟢 绿色: 合规率 ≥ 90%
  - 邮件/通知提醒

- [ ] **M1-3.5**: 创建看板页面
  - 文件: `Atlas/Index/Health_Dashboard.md`
  - 包含所有指标和可视化
  - 支持实时刷新

**交付物**:
- ✅ `Atlas/Index/Health_Dashboard.md`
- ✅ Dataview 查询模板库
- ✅ 预警配置文件

**验收标准**:
- [ ] 看板加载时间 < 3秒
- [ ] 数据准确性 ≥ 95%
- [ ] 支持历史趋势查看

---

### Milestone 1 完成标准

**退出条件**:
- [ ] ✅ Schema 合规率达到 100% (Active Notes)
- [ ] ✅ Linter 可自动化修复 90% 的常见问题
- [ ] ✅ 健康度看板实时更新且准确

**庆祝里程碑** 🎉:
- 全库 Markdown 文件通过 Linter 检查
- 发布 "v1.0 Data Readiness" 版本
- 编写 Milestone 1 完成报告

---

## Milestone 2: The Agentic Engine (Workflow Integration)

**时间框**: 2026年 3月 - 4月 (8周)
**核心目标**: 将 Obsidian 改造为 Agentic AI 的工作站

### IS/IS NOT 边界

| 维度 | ✅ IS (做什么) | ❌ IS NOT (不做什么) |
|:-----|:---------------|:---------------------|
| **范围** | 协议定义: 实施 AGENTS.md 及标准读写接口 | App 开发: 不开发自定义 Chat UI |
| **深度研究** | 工作流自动化: Topic Note → Deep Research → 填入 Evidence | 通用聊天: 不替代 ChatGPT/Claude |
| **目标** | 无摩擦 IO: Agents 可自主读写指定区域 | 全自动 Agent: 不进行无监督的长期运行 |

---

### 任务分解

#### M2-1: 定义 Agent 接口协议

**目标**: 建立 Agent 与 Obsidian 交互的标准规范

**子任务**:

- [ ] **M2-1.1**: 设计 AGENTS.md 文档结构
  ```markdown
  # AGENTS.md

  ## Agent 身份与权限
  - Agent 名称
  - 访问范围 (允许读写的目录)
  - 操作边界 (IS/IS NOT)

  ## 读写接口规范
  - 读取接口 (API)
  - 写入接口 (API)
  - 数据格式要求
  - 错误处理

  ## 安全机制
  - 写入验证
  - 冲突解决
  - 回滚机制
  ```

- [ ] **M2-1.2**: 定义读写 API 规范
  ```
  READ API:
  - agent.read_note(file_path)
  - agent.query_notes(query, filters)
  - agent.get_metadata(file_path)

  WRITE API:
  - agent.write_note(file_path, content, metadata)
  - agent.update_metadata(file_path, metadata)
  - agent.create_note(template, params)
  ```

- [ ] **M2-1.3**: 实现安全验证层
  - 路径白名单检查
  - Schema 验证
  - 写入权限检查
  - 操作日志记录

- [ ] **M2-1.4**: 编写使用示例
  - Agent 读取笔记示例
  - Agent 写入笔记示例
  - Agent 批量操作示例
  - 错误处理示例

**交付物**:
- ✅ `AGENTS.md`
- ✅ Agent 接口 Python SDK
- ✅ 使用示例库

**验收标准**:
- [ ] API 覆盖 90% 常用操作
- [ ] 安全验证无漏洞
- [ ] 文档包含 10+ 个示例

---

#### M2-2: 实现深度研究工作流

**目标**: NotebookLM + Agent 自动化深度研究

**子任务**:

- [ ] **M2-2.1**: 设计工作流架构
  ```
  用户触发
    ↓
  创建 Topic Note (带 #Status/Researching)
    ↓
  Agent 识别并触发深度研究
    ↓
  调用 NotebookLM MCP (research_start)
    ↓
  Agent 轮询研究进度 (research_status)
    ↓
  研究完成后导入 (research_import)
    ↓
  Agent 提取关键发现填入 Note
    ↓
  更新状态 #Status/Done
  ```

- [ ] **M2-2.2**: 实现触发机制
  - 基于标签触发 (#Status/Researching)
  - 基于目录触发 (2.Topics/**)
  - 手动命令触发
  - 定时任务触发

- [ ] **M2-2.3**: 实现信息提取
  - 从 NotebookLM 结果中提取:
    - 核心概念
    - 关键论据
    - 引用来源
    - 相关链接
  - 填入笔记的预定区域

- [ ] **M2-2.4**: 集成到模板
  ```javascript
  // 在笔记模板中添加
  <%*
  if (tp.file.tags.includes("#Status/Researching")) {
    // 触发深度研究
    const researchResults = await triggerDeepResearch(tp.file.title);
    // 填入证据区域
    tR += "## 研究证据\n" + researchResults.evidence;
  }
  -%>
  ```

- [ ] **M2-2.5**: 优化与迭代
  - 提取准确性评估
  - 信息相关性过滤
  - 处理失败重试机制

**交付物**:
- ✅ `5.Misc/Template/Templater/Deep_Research_Workflow.js`
- ✅ Topic Note 模板 (带深度研究)
- ✅ 工作流配置文件

**验收标准**:
- [ ] 研究耗时 < 10分钟/主题
- [ ] 信息提取准确率 ≥ 80%
- [ ] 失败率 < 5%

---

#### M2-3: 开发 Smart Tagger v2

**目标**: 基于 M1 数据标准的智能标签系统

**子任务**:

- [ ] **M2-3.1**: 重构现有标签推荐系统
  - 基于 Schema v1 规范重构
  - 简化规则引擎
  - 提升推荐准确率

- [ ] **M2-3.2**: 实现机器学习增强
  - 使用 LLM 进行标签推荐
  - 基于历史数据训练
  - A/B 测试推荐效果

- [ ] **M2-3.3**: 集成到笔记创建流程
  - 自动推荐标签
  - 一键应用标签
  - 批量标签修复

- [ ] **M2-3.4**: 实现标签质量监控
  - 实时评分
  - 质量趋势分析
  - 改进建议

**交付物**:
- ✅ `Smart_Tagger_v2.py`
- ✅ LLM 推荐引擎
- ✅ 标签质量监控面板

**验收标准**:
- [ ] 推荐准确率 ≥ 85%
- [ ] 标签一致性 ≥ 90%
- [ ] 用户采纳率 ≥ 70%

---

### Milestone 2 完成标准

**退出条件**:
- [ ] ✅ Agent 写入成功率 > 95%
- [ ] ✅ Research 耗时减少 80%
- [ ] ✅ 智能标签采纳率 ≥ 70%

**庆祝里程碑** 🎉:
- 发布 "v2.0 Agentic Engine" 版本
- 演示端到端 Agent 工作流
- 编写 Milestone 2 完成报告

---

## Milestone 3: Cognitive Augmentation (Active Intelligence)

**时间框**: 2026年 5月 - 6月 (8周)
**核心目标**: AI 主动推送洞察，而非等待用户检索

### IS/IS NOT 边界

| 维度 | ✅ IS (做什么) | ❌ IS NOT (不做什么) |
|:-----|:---------------|:---------------------|
| **范围** | 主动情报: 每周知识摘要、写作时上下文推荐 | 数据库迁移: 不迁移出 Markdown |
| **发现** | 缺口分析: 提示未关联论据、缺乏引用 | 视觉糖果: 不做华而不实的功能 |
| **目标** | 决策支持: 帮助用户更快思考和决策 | 娱乐性: 不做为了"酷"的功能 |

---

### 任务分解

#### M3-1: 开发 Weekly Knowledge Digest Agent

**目标**: 自动生成每周知识摘要

**子任务**:

- [ ] **M3-1.1**: 设计摘要模板
  ```markdown
  # Weekly Knowledge Digest - Week N

  ## 📊 本周统计
  - 新增笔记: X 篇
  - 更新笔记: Y 篇
  - 完成任务: Z 个

  ## 💡 重点洞察
  - AI 发现的关联 1
  - AI 发现的关联 2
  - AI 发现的关联 3

  ## 📚 阅读清单
  - 推荐阅读的笔记
  - 待处理的任务

  ## 🔗 知识图谱更新
  - 新增的重要连接
  - 孤立笔记提醒
  ```

- [ ] **M3-1.2**: 实现数据收集
  - 扫描本周修改的笔记
  - 提取关键信息和标签
  - 分析笔记关联

- [ ] **M3-1.3**: 实现智能摘要生成
  - 使用 LLM 生成摘要
  - 提取重点洞察
  - 识别知识缺口

- [ ] **M3-1.4**: 自动化生成和发布
  - 定时任务 (每周日)
  - 创建到 `0.DailyNotes/`
  - 发送通知

**交付物**:
- ✅ `Weekly_Knowledge_Digest_Agent.py`
- ✅ 摘要模板库
- ✅ 定时任务配置

**验收标准**:
- [ ] 生成时间 < 2分钟
- [ ] 洞察有效性 ≥ 70%
- [ ] 用户阅读率 ≥ 50%

---

#### M3-2: 创建 Contextual RAG Sidebar

**目标**: 写作时的上下文推荐侧边栏

**子任务**:

- [ ] **M3-2.1**: 设计侧边栏 UI
  ```
  ┌─────────────────────┐
  │ Contextual Sidebar  │
  ├─────────────────────┤
  │ 相关笔记 (3)         │
  │ - Note A            │
  │ - Note B            │
  │ - Note C            │
  ├─────────────────────┤
  │ 建议引用 (5)         │
  │ - Source 1          │
  │ - Source 2          │
  ├─────────────────────┤
  │ 知识缺口 (2)         │
  │ - Gap A             │
  │ - Gap B             │
  └─────────────────────┘
  ```

- [ ] **M3-2.2**: 实现相关笔记推荐
  - 基于当前笔记的标签推荐
  - 基于当前段落的关键词推荐
  - 实时更新推荐列表

- [ ] **M3-2.3**: 实现引用建议
  - 从知识库中查找相关论据
  - 支持的证据引用
  - 反驳观点引用

- [ ] **M3-2.4**: 实现缺口分析
  - 识别未论证的观点
  - 识别缺乏引用的论断
  - 提供补充建议

**交付物**:
- ✅ Obsidian 插件原型
- ✅ RAG 推荐引擎
- ✅ UI/UX 设计

**验收标准**:
- [ ] 推荐响应时间 < 1秒
- [ ] 推荐准确率 ≥ 75%
- [ ] 用户使用率 ≥ 40%

---

#### M3-3: 开发 Knowledge Gap Analyzer

**目标**: 分析知识缺口并提供改进建议

**子任务**:

- [ ] **M3-3.1**: 定义缺口类型
  ```
  缺口类型:
  ├── 论证缺口: 观点缺乏证据支持
  ├── 引用缺口: 事实缺乏来源
  ├── 关联缺口: 相关笔记未链接
  ├── 更新缺口: 内容已过时
  └── 完整性缺口: 系统性知识缺失
  ```

- [ ] **M3-3.2**: 实现缺口检测算法
  - 论证逻辑分析
  - 引用完整性检查
  - 关联性分析
  - 新鲜度评估

- [ ] **M3-3.3**: 生成缺口报告
  ```markdown
  # Knowledge Gap Analysis Report

  ## 高优先级缺口 (3)
  - Gap 1: [描述] [建议行动]
  - Gap 2: [描述] [建议行动]
  - Gap 3: [描述] [建议行动]

  ## 中优先级缺口 (5)
  ...

  ## 低优先级缺口 (10)
  ...
  ```

- [ ] **M3-3.4**: 实现智能建议
  - 推荐需要补充的内容
  - 推荐需要阅读的资源
  - 推荐需要连接的笔记

**交付物**:
- ✅ `Knowledge_Gap_Analyzer.py`
- ✅ 缺口检测算法库
- ✅ 报告模板

**验收标准**:
- [ ] 缺口识别准确率 ≥ 80%
- [ ] 建议有效性 ≥ 70%
- [ ] 报告生成时间 < 1分钟

---

### Milestone 3 完成标准

**退出条件**:
- [ ] ✅ 每周产生 > 3 个有效洞察
- [ ] ✅ 写作辅助使用率 ≥ 40%
- [ ] ✅ 缺口分析准确率 ≥ 80%

**庆祝里程碑** 🎉:
- 发布 "v3.0 Cognitive Augmentation" 版本
- 组织内部分享会
- 编写 Milestone 3 完成报告

---

## 📊 总体进度跟踪

### 里程碑完成度

| 里程碑 | 计划开始 | 预计完成 | 当前进度 | 状态 |
|:--------|:---------|:---------|:---------|:-----|
| M0 | 2026-01-26 | 2026-01-26 | 100% | ✅ 完成 |
| M1 | 2026-02-01 | 2026-02-28 | 0% | 🚧 未开始 |
| M2 | 2026-03-01 | 2026-04-30 | 0% | ⏳ 待开始 |
| M3 | 2026-05-01 | 2026-06-30 | 0% | ⏳ 待开始 |

### 成功指标追踪

| 指标 | 当前值 | 目标值 | 截止时间 | 状态 |
|:-----|:-------|:-------|:---------|:-----|
| Schema 合规率 | 未知 | 100% | 2026-02-28 | ⏳ |
| Agent 写入成功率 | 未知 | >95% | 2026-04-30 | ⏳ |
| Research 耗时减少 | 0% | 80% | 2026-04-30 | ⏳ |
| 每周有效洞察数 | 0 | >3 | 2026-06-30 | ⏳ |

---

## 🔄 迭代与改进

### 每周回顾

- [ ] 检查任务完成情况
- [ ] 更新进度指标
- [ ] 识别阻塞和风险
- [ ] 调整下周计划

### 每月回顾

- [ ] 评估里程碑进度
- [ ] 审查成功指标
- [ ] 收集用户反馈
- [ ] 优化工作流程

### 季度回顾

- [ ] 总结里程碑成果
- [ ] 规划下季度工作
- [ ] 更新优化线路图
- [ ] 庆祝里程碑完成

---

**创建者**: Claude Sonnet 4.5
**最后更新**: 2026-01-26
**下次审查**: 2026-02-02
