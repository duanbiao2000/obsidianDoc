---
date: 2025-06-26 22:37
view-count: 18
update: 2026-01-07 00:15
related:
  - "[[No Magic, Just Code设计哲学]]"
  - "[[2025-12-20-常用开发标记]]"
  - "[[2025-12-06-企业应用架构模式]]"
---

# [[2.Topics/进阶/设计模式]] | Minimal

---

## 0. 本质 (The Essence)

- **创建型**：如何高效 new。
- **结构型**：如何组装类/对象。
- **行为型**：如何分配职责与通信。

---

## 1. 核心九式速查

| 模式       | 核心逻辑   | 典型应用      | 吐槽            |
| :------- | :----- | :-------- | :------------ |
| **单例**   | 唯一实例   | 日志/连接池    | 容易变全局耦合坑      |
| **工厂方法** | 子类决定实例 | 游戏角色生成    | 避免 if-else 散落 |
| **抽象工厂** | 创建产品族  | 跨平台 UI 套件 | 高级但结构重        |
| **适配器**  | 接口转换   | 兼容老 API   | 救火队员专用        |
| **装饰者**  | 动态包装   | IO 流/咖啡加料 | 比继承灵活的“乐高”    |
| **代理**   | 控制访问   | 懒加载/权限检查  | 它是中间商         |
| **观察者**  | 一对多通知  | 事件监听/消息订阅 | 生产环境建议用 MQ    |
| **策略**   | 算法动态替换 | 支付方式/排序算法 | 消除臃肿分支        |
| **责任链**  | 请求沿链传递 | 拦截器/审批流   | 接力赛模式         |

---

## 2. 逻辑骨架 (Minimal Code)

- **单例**：`if not instance: instance = New()`
- **工厂**：`creator.create() -> Product`
- **策略**：`context.setStrategy(A); context.run()`
- **装饰**：`new Decorator(new Component())`
- **代理**：`Proxy.request() { check(); realSubject.request(); }`
- **观察者**：`subject.notify() { for o in obs: o.update() }`

---

## 3. 避坑指南 (Brutal Truths)

- **单例不是银弹**：它是披着模式外衣的全局变量，难测试、高耦合。
- **组合优于继承**：能用装饰者/策略，就不要写深层的继承树。
- **不要过度设计**：
  - 只有 2 个分支？用 `if-else`。
  - 只有 3 个类？直接 `new`。
  - **YAGNI** (You Ain't Gonna Need It) 是最高优先级。
- **模式的终局**：代码写到最后，模式应该消失在业务逻辑里，而不是处处显摆。

---

## 4. 决策树

1. **创建逻辑复杂？** → 工厂。
2. **要给旧代码打补丁？** → 适配器。
3. **功能要动态堆叠？** → 装饰者。
4. **算法经常变？** → 策略。
5. **需要解耦多方通信？** → 观察者。

---

**原则**：KISS (Keep It Simple, Stupid)。模式是为了解决复杂度，不是制造复杂度。

### 设计模式：系统演化的策略基元

设计模式是系统在演化中沉淀下来的、经过验证的**策略基元**。它们不是代码技巧，而是应对特定系统博弈（如资源调度、边界管理、行为交互）的、被高度压缩的解决方案。

掌握它们，就是掌握了一套高效的**“策略压缩通道”**，能极大降低团队的沟通与认知成本。

| 模式分类 | 核心策略问题 | 策略基元 (示例) |
| :--- | :--- | :--- |
| **创建型** | 如何以可控、解耦的方式**生成系统组件**？ | **单例**: 唯一性资源访问控制<br>**工厂**: 决策权下放与依赖倒置<br>**建造者**: 复杂构建过程的认知负载压缩 |
| **结构型** | 如何组织系统拓扑以**管理边界、增强功能**？ | **适配器/外观**: 系统边界的接口转译与复杂度屏蔽<br>**装饰器/代理**: 对核心组件的非侵入式能力增强<br>**组合**: “部分-整体”层级结构的统一化处理 |
| **行为型** | 如何定义组件间的交互范式以实现**动态协作与演化**？ | **策略/模板方法**: 算法族的封装与替换，打破路径依赖<br>**观察者**: 事件驱动的发布-订阅解耦<br>**命令**: 将“请求”对象化，实现对行为的元控制 |

### 结论：压缩的战略智慧

设计模式的本质，是将复杂的系统博弈压缩为可复用的**策略语言**。

它们是架构师的词典，是系统演化的脚手架，更是**路径压缩艺术**在代码世界中的精炼表达。