---
date: 2025-05-19 13:58
tags:
  - business-logic-separation
  - layered-architecture
  - domain-driven-design
  - architecture
  - Type/Reference
  - Domain/Technology
  - business-logic-separation
  - layered-architecture
  - domain-driven-design
  - architecture
view-count: 14
related:
  - '[[模型抽象]]'
  - '[[领域驱动设计]]'
  - '[[2025-12-06-企业应用架构模式]]'
  - '[[目标驱动系统]]'
  - '[[2025-12-20-商业模式画布]]'
  - '[[2025-12-11-视野分层]]'
  - '[[计算机科学技能应用于现实问题建模的100个关键点]]'
  - '[[Database and Storage]]'
  - '[[Spec-Driven Development（规格驱动开发）]]'
update: 2026-01-08 22:30
---
# 领域驱动设计 (DDD)：极简架构指南

---

### 一、 核心本质
**业务模型驱动代码**。
目标：将**核心业务逻辑**与**技术细节**彻底解耦，使代码结构即业务语义。

### 二、 四层架构模型 (Layered Architecture)

| 层级 | 职责 | 关注点 | 依赖方向 |
| :--- | :--- | :--- | :--- |
| **1. Interface (接口层)** | 协议转换、DTO 封装 | Web/RPC/MQ 适配 | ↓ 调用 App |
| **2. Application (应用层)** | 用例编排、事务、权限 | 业务流程 (无业务规则) | ↓ 调用 Domain |
| **3. Domain (领域层)** | ★ 实体、VO、聚合、规则 | **业务核心 (无技术依赖)** | 核心 |
| **4. Infrastructure (基础层)** | DB、缓存、MQ 实现 | 技术细节 (Repository 实现) | ↑ 支撑全层 |

### 三、 领域对象矩阵

| 对象 | 唯一标识 (ID) | 状态 | 行为 | 例子 |
| :--- | :--- | :--- | :--- | :--- |
| **Entity (实体)** | 有 | 可变，有生命周期 | 包含核心业务逻辑 | 用户、订单 |
| **Value Object (VO)** | 无 (属性即身份) | **不可变** | 包含校验/计算逻辑 | 货币、地址 |
| **Aggregate (聚合)** | 聚合根 ID | 一致性边界 | 守卫内部一致性 | 订单+订单项 |

### 四、 核心模式：Repository vs. Mapper

- **Repository (领域层接口)**：面向**聚合根**。定义“我要什么数据”，隐藏存储细节。
- **Mapper (基础层实现)**：面向**数据表**。处理 SQL 映射、DO 转换。
- **本质区别**：Repository 是业务契约，Mapper 是技术实现。

### 五、 协作逻辑流 (Logic Flow)
1. **Application** 接收请求 $\rightarrow$ 
2. 通过 **Repository** 加载 **Aggregate** $\rightarrow$ 
3. 执行 **Aggregate/Entity** 内部行为 (业务规则) $\rightarrow$ 
4. 通过 **Repository** 保存状态。

### 六、 避坑指南 (Anti-Patterns)
- ❗ **贫血模型**：只有 Getter/Setter 的实体。**药方**：逻辑移回实体。
- ❗ **胖应用服务**：在 Application 层写业务规则。**药方**：逻辑移入 Domain。
- ❗ **技术侵入**：Domain 层引用了 Spring/MyBatis。**药方**：通过 Repository 接口解耦。
- ❗ **聚合过大**：将整个 DB 连成一个大聚合。**药方**：以事务一致性为最小边界。

### 七、 极简金句
**逻辑在 Domain，流程在 App，技术在 Infra；代码不只是运行的机器，更是业务的说明书。**

在领域驱动设计（DDD）中，没有一套固定的“经典业务领域模型”，因为模型总是与具体的业务需求和上下文紧密相关。然而，在 DDD 的学习和实践中，确实有一些常见的、具有代表性的业务领域经常被用作示例或案例研究，来演示 DDD 的概念和模式。这些领域通常具有一定的复杂性，适合用来展现如何进行领域建模和划分限界上下文。

以下是一些在 DDD 讨论中经常出现的经典业务领域示例：

1. **电子商务 (E-commerce)**：包括商品目录、库存管理、订单处理、支付、运输等子领域。这是非常典型的例子，用来演示聚合根（如 Order）、实体（如 Product, Customer）、值对象（如 Address, Money）以及不同限界上下文（Catalog Context, Order Context, Shipping Context）的划分。
2. **金融/银行 (Finance/Banking)**：涉及账户、交易、贷款、支付清算等。这个领域通常有复杂的业务规则和一致性要求，适合演示聚合根（如 Account）、事务处理和不变性。
3. **运输/物流 (Shipping/Logistics)**：包括货物、运输计划、路线、船只/车辆、位置跟踪等。用于演示复杂的状态变化（Shipment Lifecycle）和跨多个实体的协作。
4. **保险 (Insurance)**：涵盖保单管理、理赔处理、风险评估等。这个领域有许多规则和复杂的业务流程。
5. **医疗保健 (Healthcare)**：例如病人管理、预约排程、电子病历、处方等。涉及敏感数据和严格的业务流程。
