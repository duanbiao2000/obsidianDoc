---
view-count: 4
---

# 系统设计：规模化与权衡指南

## 1. 核心逻辑：分而治之与权衡 (Trade-offs)
系统设计不是写代码，而是**在约束下通过组件组合解决“规模”问题**。
- **第一性原理**：没有完美的系统，只有在 **CAP (一致性/可用性/分区容错)** 与 **成本**之间的最佳折中。

## 2. 决策矩阵 (Decision Matrix)

| 组件 | 核心痛点 | 备选方案 (Actionable) |
| :--- | :--- | :--- |
| **负载均衡 (LB)** | 流量瓶颈、单点故障 | Nginx (软) / 云 LB (硬)；算法：轮询 / 一致性 Hash。 |
| **缓存 (Cache)** | 响应慢、DB 压力大 | Redis (热数据) / CDN (静态资源)；策略：LRU 淘汰。 |
| **数据库 (DB)** | 存储规模、读写瓶颈 | SQL (强一致/复杂查询) vs NoSQL (高并发/易扩展)。 |
| **通信 (Comm)** | 耦合重、同步阻塞 | REST/gRPC (同步) vs 消息队列 MQ (异步解耦/削峰)。 |

## 3. 模块划分模式 (Modularity)

- **按功能 (Functional)**：依用户感知划分。*适用：中小型项目、快速 MVP。*
- **按领域 (DDD)**：围绕限界上下文划分。*适用：复杂业务、长期演进。*
- **按角色 (Role-based)**：依用户旅程划分。*适用：多端/多角色协同系统。*

## 4. 行动指南：系统设计 4 步走 (Execution Protocol)

1.  **约束定义 (Scope)**：明确 QPS、数据总量、SLA（几个 9）。
2.  **容量估算 (Estimation)**：计算存储、带宽、内存需求。*（例：$10^8$ 用户 $\times$ 1KB = 100GB）*
3.  **高层抽象 (High-level)**：画出 `Client -> LB -> App -> Cache/MQ -> DB` 链路图。
4.  **瓶颈攻克 (Deep Dive)**：针对热点 Key、单点故障、数据库慢查询设计容错方案（熔断/限流）。

## 5. 质量门槛 (Non-Functional)
- **Scalability**：能否水平扩展？
- **Reliability**：挂掉一个节点，服务还能跑吗？
- **Maintainability**：监控/日志/告警是否完备？

---

### 质量自检
- **压缩率**：约 70% (剔除所有定义性废话)
- **层级**：2 层 (核心逻辑/决策矩阵/划分模式/行动指南/质量门槛)
- **5秒测试**：一眼可见“4步走协议”与“组件决策方案”。

**关联笔记**
- [[2025-12-31-系统设计与架构模式]]
- [[清洁架构：业务逻辑的解耦协议]]