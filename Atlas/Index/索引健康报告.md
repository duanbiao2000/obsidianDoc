---
tags:
  - Type/DataviewQuery
  - Domain/Cognitive
  - vault-maintenance
update: 2026-01-26
---

# ç´¢å¼•å¥åº·æŠ¥å‘Š

> è‡ªåŠ¨ç”Ÿæˆæ—¶é—´: 2026-01-26
> æœ¬æ–‡ä»¶æä¾›çŸ¥è¯†åº“ç´¢å¼•ç³»ç»Ÿçš„å¥åº·ç›‘æ§

## ğŸ” 1. å­¤ç«‹ç¬”è®°æ£€æµ‹

æŸ¥æ‰¾é“¾æ¥æ•° < 2 çš„ç¬”è®°(å¯èƒ½æ˜¯å­¤ç«‹ç¬”è®°)

```dataviewjs
// æŸ¥æ‰¾é“¾æ¥æ•°<2çš„ç¬”è®°
const orphanNotes = dv.pages()
  .where(p => {
    const links = p.file.inlinks.length + p.file.outlinks.length;
    return links < 2 && !p.file.name.startsWith('_Index_of') && !p.file.folder.includes('Attachments');
  });

dv.paragraph(`å­¤ç«‹ç¬”è®°æ•°: ${orphanNotes.length}`);

if (orphanNotes.length > 0) {
  dv.table(
    ["æ–‡ä»¶", "å…¥é“¾", "å‡ºé“¾", "æ–‡ä»¶å¤¹"],
    orphanNotes
      .limit(20)
      .map(p => [
        p.file.link,
        p.file.inlinks.length,
        p.file.outlinks.length,
        p.file.folder
      ])
  );
} else {
  dv.paragraph("âœ… æ²¡æœ‰å‘ç°å­¤ç«‹ç¬”è®°!");
}
```

---

## ğŸ“‚ 2. ç´¢å¼•å®Œæ•´æ€§æ£€æŸ¥

æ£€æŸ¥æ¯ä¸ªç›®å½•æ˜¯å¦éƒ½æœ‰ç´¢å¼•æ–‡ä»¶

```dataviewjs
// æ£€æŸ¥ä¸»è¦ç›®å½•æ˜¯å¦éƒ½æœ‰ç´¢å¼•æ–‡ä»¶
const mainDirs = [
  "0.DailyNotes",
  "1.Projects",
  "2.Topics",
  "3.Resources",
  "5.Misc",
  "Atlas"
];

const missingIndexes = [];

for (const dir of mainDirs) {
  const indexName = `_Index_of_${dir.split('/').pop()}.md`;
  const hasIndex = dv.pages().where(p =>
    p.file.name === indexName &&
    p.file.folder.startsWith(dir)
  ).length > 0;

  if (!hasIndex) {
    missingIndexes.push(dir);
  }
}

if (missingIndexes.length > 0) {
  dv.paragraph("âŒ ç¼ºå°‘ç´¢å¼•çš„ç›®å½•:");
  dv.list(missingIndexes);
} else {
  dv.paragraph("âœ… æ‰€æœ‰ä¸»è¦ç›®å½•éƒ½æœ‰ç´¢å¼•æ–‡ä»¶!");
}
```

---

## ğŸ·ï¸ 3. æ ‡ç­¾ä¸€è‡´æ€§æ£€æŸ¥

æ£€æŸ¥æ ‡ç­¾æ˜¯å¦éµå¾ªä¸‰å±‚è§„èŒƒ

```dataviewjs
// æ£€æŸ¥ä¸è§„èŒƒçš„æ ‡ç­¾
const allPages = dv.pages().where(p => p.file.tags.length > 0);
const issues = [];

allPages.forEach(p => {
  p.file.tags.forEach(tag => {
    // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨ #Domain/, #Status/, #Type/ æ ¼å¼
    if (!tag.startsWith('#') && tag.includes('/')) {
      issues.push([p.file.link, tag, "ç¼ºå°‘ # å‰ç¼€"]);
    }
    // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨æ—§æ ¼å¼æ ‡ç­¾
    if (tag.startsWith('#') && !tag.includes('/') && tag.length > 2) {
      issues.push([p.file.link, tag, "æœªä½¿ç”¨åˆ†å±‚æ ‡ç­¾"]);
    }
  });
});

if (issues.length > 0) {
  dv.paragraph(`å‘ç° ${issues.length} ä¸ªæ ‡ç­¾é—®é¢˜:`);
  dv.table(["æ–‡ä»¶", "æ ‡ç­¾", "é—®é¢˜"], issues.slice(0, 20));
} else {
  dv.paragraph("âœ… æ ‡ç­¾æ ¼å¼æ£€æŸ¥é€šè¿‡!");
}
```

---

## ğŸ“Š 4. ç´¢å¼•è¦†ç›–ç‡ç»Ÿè®¡

```dataviewjs
// ç»Ÿè®¡ç´¢å¼•è¦†ç›–ç‡
const allFiles = dv.pages().where(p => p.file.extension === 'md');
const indexFiles = allFiles.where(p => p.file.name.startsWith('_Index_of_'));

const coverage = (indexFiles.length / allFiles.length * 100).toFixed(1);

dv.paragraph(`æ€»æ–‡ä»¶æ•°: ${allFiles.length}`);
dv.paragraph(`ç´¢å¼•æ–‡ä»¶æ•°: ${indexFiles.length}`);
dv.paragraph(`ç´¢å¼•è¦†ç›–ç‡: ${coverage}%`);

// ç›®æ ‡è¦†ç›–ç‡ > 85%
if (coverage >= 85) {
  dv.paragraph("âœ… ç´¢å¼•è¦†ç›–ç‡è¾¾æ ‡!");
} else {
  dv.paragraph("âš ï¸ ç´¢å¼•è¦†ç›–ç‡ä½äºç›®æ ‡ 85%");
}
```

---

## ğŸ“ 5. ç›®å½•ç»“æ„åˆ†æ

```dataviewjs
// åˆ†æå„ç›®å½•çš„æ–‡ä»¶æ•°
const dirs = dv.pages()
  .groupBy(p => p.file.folder.split('/')[0])
  .filter(p => p.key && !p.key.includes('Attachments') && !p.key.includes('.trash'));

dv.table(["é¡¶çº§ç›®å½•", "æ–‡ä»¶æ•°", "å¹³å‡é“¾æ¥æ•°"],
  dirs.map(p => [
    p.key,
    p.rows.length,
    (p.rows.reduce((sum, page) =>
      sum + page.file.inlinks.length + page.file.outlinks.length, 0
    ) / p.rows.length).toFixed(1)
  ])
  .sort(p => p[1], 'desc')
);
```

---

## ğŸ”„ 6. æœ€è¿‘æ›´æ–°çš„ç´¢å¼•æ–‡ä»¶

```dataview
TABLE
  file.mtime AS "æœ€åä¿®æ”¹",
  tags AS "æ ‡ç­¾"
FROM ""
WHERE contains(file.name, "_Index")
SORT file.mtime DESC
LIMIT 10
```

---

## ğŸ“‹ 7. å¾…å¤„ç†ä»»åŠ¡

```dataview
TASK
WHERE !completed
AND (contains(text, "ç´¢å¼•") OR contains(text, "Index") OR contains(text, "æ ‡ç­¾"))
SORT file.mtime DESC
LIMIT 20
```

---

## ğŸ¯ å¥åº·è¯„åˆ†

```dataviewjs
// è®¡ç®—æ•´ä½“å¥åº·è¯„åˆ†
let score = 100;

// å­¤ç«‹ç¬”è®°æ‰£åˆ†
const orphans = dv.pages()
  .where(p => (p.file.inlinks.length + p.file.outlinks.length) < 2)
  .length;
score -= Math.min(orphans * 0.5, 20);

// ç´¢å¼•è¦†ç›–ç‡æ‰£åˆ†
const allFiles = dv.pages().length;
const indexFiles = dv.pages().where(p => p.file.name.startsWith('_Index_of_')).length;
const coverage = indexFiles / allFiles;
if (coverage < 0.85) score -= (0.85 - coverage) * 100;

// æ˜¾ç¤ºè¯„åˆ†
score = Math.max(0, Math.min(100, score)).toFixed(0);

let grade = "ä¼˜ç§€";
if (score < 90) grade = "è‰¯å¥½";
if (score < 75) grade = "åŠæ ¼";
if (score < 60) grade = "éœ€æ”¹è¿›";

dv.header(3, "æ•´ä½“å¥åº·è¯„åˆ†: " + score + "/100 (" + grade + ")");

if (score >= 90) {
  dv.paragraph("âœ… çŸ¥è¯†åº“ç´¢å¼•ç³»ç»ŸçŠ¶å†µè‰¯å¥½!");
} else if (score >= 75) {
  dv.paragraph("âš ï¸ çŸ¥è¯†åº“ç´¢å¼•ç³»ç»ŸåŸºæœ¬æ­£å¸¸,æœ‰æ”¹è¿›ç©ºé—´");
} else {
  dv.paragraph("âŒ çŸ¥è¯†åº“ç´¢å¼•ç³»ç»Ÿéœ€è¦ä¼˜åŒ–");
}
```

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [[ä»“åº“æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ]] - æ ‡ç­¾è§„èŒƒåŒ–
- [[_Index_of_Index]] - Index ç›®å½•ç´¢å¼•
- [[Atlas/BASE/å†…å®¹è´¨é‡è¯„ä¼°æ ‡å‡†]] - ç¬”è®°è´¨é‡æ ‡å‡†
