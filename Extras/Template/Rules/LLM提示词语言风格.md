

这段提示词的语言风格可以被描述为：

1.  **指令性强且明确 (Highly Directive and Explicit):** 大量使用祈使句和情态动词（如“你要”、“需要”、“必须”、“应该”、“不得”、“禁止”、“绝对不要”），直接下达操作指令，清晰界定任务范围和行为边界，几乎没有模糊或可选择的空间。
2.  **结构化和逻辑清晰 (Structured and Logically Clear):** 使用清晰的标题（##）、项目符号（-）、代码块等方式组织内容，将复杂的任务分解为多个步骤。在指令之间，经常阐述逻辑关系和原因（例如，“...这是荒谬不合逻辑的”），帮助理解指令背后的目的。
3.  **精确且偏技术化 (Precise and Somewhat Technical):** 运用了与文本处理、数据结构（XML 标签如 `<response>`, `<page>`, `<ref>`), 错误类型 (OCR 识别错误) 和操作相关的特定术语。对细节要求非常具体，例如标签名称、属性、内容格式等。
4.  **注重规则和约束 (Rule-Oriented and Constraint-Focused):** 反复强调规则、限制和禁止项（“严禁超过”、“不得打乱”、“不得遗漏”等）。不仅说明要做什么，更着重强调不能做什么，以确保输出符合严格的规范。
5.  **预见性与问题解决导向 (Anticipatory and Problem-Solving Oriented):** 提示词预设了可能遇到的问题（如跨页文本、OCR错误、引用匹配问题），并提供了具体的思考模式（“模仿我的思考模式，举一反三”）和解决策略或修复步骤。
6.  **正式且权威 (Formal and Authoritative):** 语言表达较为正式、书面化，体现出一种设定标准、指导执行的权威口吻。

总而言之，这是一种为确保机器（LLM）能够准确、无歧义地执行复杂、多步骤、格式要求严格的任务而精心设计的**高度规范化、指令清晰、逻辑严谨、注重细节和错误处理的技术说明性语言风格**。它优先考虑的是准确性、一致性和可控性。


## LLM 提示词范例：复杂文本处理与结构化输出

**任务目标：**

你需要处理用户分多页提交的文本内容（可能包含摘要信息）。你的任务是：

1.  **通读全文**（包括 `summary` 和所有 `page` 内容）。
2.  **生成一份总结** (`<abstract>`)。
3.  **清理和整合正文**：修复 OCR 错误，合并跨页文本段落，处理被分割的单词。
4.  **处理引用标记**：将正文中的引用编号与同页的引用文献建立链接。
5.  **结构化输出**：将处理后的总结和正文，按照指定的 XML 格式 (`<response>`) 输出。

**核心要求与约束：**

*   **输出格式：** 最终输出必须以 `<response>` 标签作为根节点包裹。
*   **内容准确性：** 不得遗漏、缩写或增加原文不存在的内容。
*   **顺序保持：** 严格按照原文的阅读顺序（`page` 的 `idx` 从小到大，`page` 内从上到下）组织 `<content>` 中的元素。`figure`, `table`, `formula` 等元素必须保持其与文本的相对位置。
*   **风格一致：** 总结和处理文本时，语言风格需与输入文本保持一致。

**详细步骤与规则：**

**1. 生成全文总结 (`<abstract>`)**

*   **内容来源：** 融合用户提交的 `summary` 标签内容（若存在）和所有 `page` 标签中的正文内容。
*   **内容覆盖：** 总结必须同时覆盖 `summary` 和所有 `page` 的内容，详略得当，不能只偏重一方。
*   **字数限制：** 总结字数需超过 200 字，但**严禁**超过 300 字。
*   **表达方式：** 使用纯文本，平铺直叙，不得进行点评或引用原文片段。**禁止**直接抄袭 `summary` 内容，必须用自己的话转述。
*   **输出标签：** 总结内容用 `<abstract>` 标签包裹。

**2. 拼接、调整、转移正文 (`<content>`)**

*   **内容来源：** 将所有 `page` 标签内的正文内容（**不包括** `<citations>` 标签的内容）誊写到 `<content>` 标签中。
*   **允许的子标签：** `<content>` 的直接子节点应包含来自 `page` 的 `headline`, `text`, `figure`, `table`, `formula` 区块（经过你的调整和转换）。
*   **跨页文本处理：**
    *   识别因分页而被分割的 `text` 标签（自然段、句子、甚至单词）。
    *   将这些碎片**合并**成一个逻辑上完整的 `text` 标签。合并后的 `text` 标签必须代表完整的自然段。
    *   处理跨页合并的单词和句子，确保其流畅自然。
*   **区块 `idx` 属性：** `<content>` 中的每个子标签（`headline`, `text`, `figure` 等）都**必须**有一个 `idx` 属性，标明其内容**主要**来自哪个原始 `page`。对于由多个跨页 `text` 合并而成的标签，`idx` 属性应包含所有相关的原始 `page` 索引，用逗号隔开（例如 `idx="1,2"`）。
*   **OCR 错误修复与格式调整：**
    *   在处理过程中，主动识别并修复明显的 OCR 识别错误。参考以下**思考模式示例**进行推理：
        *   **字符替换：** 基于字形相似性（如 `l` -> `i`, `o` -> `。`, `C` -> `（`）和上下文逻辑（如中英文标点混用、括号不成对）进行修正。参考示例中 "Winnicott", "《对转移的分析》" 的修复。
        *   **无效内容删除：** 删除明显错误的插入内容，如误入的页码数字 (示例中的 "172")。
        *   **空格与标点：** 删除多余空格，补全缺失的句末标点。
    *   根据内容和上下文，合理调整原有的区块标签类型（如有必要，但优先尊重原始划分）。

**3. 标注引用 (`<ref>`)**

*   **输入识别：** 某些 `page` 标签末尾可能包含 `<citations>` 标签，内含多个 `<citation id="XXX">` 子标签，每个 `<citation>` 包含 `<label>`（引用编号，如①, [1], *）和 `<text>`（引用文献文本）。
*   **匹配规则：**
    *   在**同一页 (`page`)** 的正文区域内，查找与该页 `<citations>` 中 `<label>` 相对应的引用编号。
    *   将正文中找到的引用编号替换为 `<ref id="XXX"/>` 标签，其中 `XXX` 是对应 `<citation>` 标签的 `id` 属性值。
*   **错误处理与修复：**
    *   **首要策略：** 利用上下文逻辑和可能的 OCR 错误模式（如编号 `①` 识别成 `CD`, `[1]` 识别成 `Il]`），尝试修复正文或 `<label>` 中的编号，以最大化匹配数量。思考调整方案是否使逻辑更通顺。
    *   **无法匹配的处理：** 如果在**同一页内**，经过修复尝试后，正文中仍有引用编号找不到对应的 `<citation>`，则**删除**该正文中的编号。这通常发生在正文编号多于引用条目时。
    *   **核心禁忌：** **绝对不要**跨页匹配引用。一个 `page` 内的引用标记只能与该 `page` 内 `<citations>` 中的条目匹配。

**示例（展示部分修复逻辑和输出结构）：**

```xml
<!-- 假设原始输入包含类似 "Wlannicott", "（（对转移的分析》", "Tran-\nsference" 等错误 -->
<response>
  <abstract>凯斯门特在此回顾了温尼科特的观点，并针对吉尔在其著作《对转移的分析》中过分强调分析师角色的做法表达了批评意见。凯斯门特认为吉尔的这种侧重显得有些夸张和失衡，未能恰当反映分析情境的复杂性，与温尼科特等人的观点形成了对比，提示我们需要更全面地理解转移现象中分析师与来访者的互动关系及其限度。</abstract>
  <content>
    <text idx="1">
      凯斯门特很可能会想起温尼科特（Winnicott, 1949, p.74）的评论。
    </text>
    <quote idx="1">
      令人好奇的是，我觉得精神分析文献中最无聊的强迫性理论作品之一是，吉尔（Gill, 1982）的《对转移的分析》（Analysis of Transference），他在其中夸大了分析家在分析情境中的角色的重要性。
    </quote>
    <!-- 其他来自 page 1 或后续 page 的 content -->
  </content>
</response>
```

---

**总结这个范例提示词的特点：**

*   **目标明确：** 清晰定义了最终要实现的任务。
*   **结构化指令：** 将复杂任务分解为多个逻辑步骤，并使用标题和列表。
*   **细节丰富：** 对 OCR 修复、文本合并、引用处理、XML 结构等都有具体的操作指导和规则。
*   **包含示例和思考模式：** 通过具体例子展示了错误修复的思路，有助于 LLM 理解和模仿。
*   **强调约束和禁止项：** 明确指出了不能做什么，减少了歧义和错误空间。
*   **问题导向：** 预见了可能出现的问题（OCR 错误、引用不匹配）并提供了处理策略。
*   **输出导向：** 明确规定了最终输出的格式和结构。

这个范例展示了如何为需要精确文本操作和结构化输出的复杂任务构建高质量的 LLM 提示词。