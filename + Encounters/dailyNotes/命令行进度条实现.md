---
title: 命令行进度条实现
date: 2024-11-13 10:18
categories:
  - Diary
tags:
  - GitHub
  - Code
---

总结

<!--more-->
# 命令行进度条实现
你提供的代码片段展示了如何使用 `progress` 包来创建一个进度条。让我们详细解释一下这段代码的各个部分：

### 代码解析

```javascript
const ProgressBar = require('progress');
```

首先，我们引入 `progress` 包的 `ProgressBar` 类。

```javascript
const bar = new ProgressBar('[:bar] :current/:total (:percent) :etas', {
  total: 100,
  width: 20,
  complete: '=',
  incomplete: ' ',
  renderThrottle: 1000
});
```

接下来，我们创建一个新的 `ProgressBar` 实例，并传入两个参数：

1. **格式字符串**：`'[:bar] :current/:total (:percent) :etas'`
   - `[:bar]`：表示进度条本身。
   - `:current`：当前进度值。
   - `:total`：总进度值。
   - `(:percent)`：当前进度的百分比。
   - `:etas`：预计完成时间（ETA，Estimated Time of Arrival）。

2. **配置对象**：
   - `total: 100`：设置进度条的总长度为 100。
   - `width: 20`：设置进度条的宽度为 20 个字符。
   - `complete: '='`：设置已完成部分的字符为 `=`。
   - `incomplete: ' '`：设置未完成部分的字符为空格。
   - `renderThrottle: 1000`：设置每秒最多渲染一次进度条，以减少屏幕闪烁。

### 使用进度条

创建进度条实例后，你可以通过调用 `tick` 方法来更新进度。每次调用 `tick` 方法，进度条会前进一个单位。

```javascript
for (let i = 0; i < 100; i++) {
  setTimeout(() => {
    bar.tick();
  }, 100 * i);
}
```

在这段代码中，我们使用 `setTimeout` 来模拟一个异步任务，每 100 毫秒调用一次 `bar.tick()`，使进度条逐渐前进，直到达到 100。

### 完整示例

下面是一个完整的示例，展示了如何创建和使用进度条：

```javascript
const ProgressBar = require('progress');

// 创建进度条实例
const bar = new ProgressBar('[:bar] :current/:total (:percent) :etas', {
  total: 100,
  width: 20,
  complete: '=',
  incomplete: ' ',
  renderThrottle: 1000
});

// 模拟异步任务
for (let i = 0; i < 100; i++) {
  setTimeout(() => {
    bar.tick();
  }, 100 * i);
}
```

### 解释

1. **格式字符串**：
   - `[:bar]`：进度条本身。
   - `:current/:total`：当前进度值和总进度值。
   - `(:percent)`：当前进度的百分比。
   - `:etas`：预计完成时间。

2. **配置对象**：
   - `total: 100`：总进度值为 100。
   - `width: 20`：进度条宽度为 20 个字符。
   - `complete: '='`：已完成部分的字符为 `=`.
   - `incomplete: ' '`：未完成部分的字符为空格。
   - `renderThrottle: 1000`：每秒最多渲染一次进度条。

3. **模拟异步任务**：
   - 使用 `setTimeout` 模拟一个异步任务，每 100 毫秒调用一次 `bar.tick()`，使进度条逐渐前进。

### 运行效果

当你运行这段代码时，你会看到类似以下的输出：

```
[==================] 100/100 (100%) 0.0s
```

这个输出表示进度条已经完成了 100%，并且显示了完成的时间。

希望这能帮助你更好地理解和使用 `progress` 包！如果你有任何其他问题，请随时提问。